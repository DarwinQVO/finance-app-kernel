# UX Flow: Parser Registry Experience (3.7)

> **Vertical:** 3.7 Parser Registry
> **Last Updated:** 2025-10-24

---

## Overview

This document details 6 user journeys for parser discovery, selection, and version management with wireframes and multi-domain examples.

---

## Journey 1: Auto-Detected Parser (High Confidence)

**User Story:** As a user, I upload a Bank of America statement and the system automatically selects the correct parser.

### Flow

```
1. User drags "BofA_Statement_Nov2024.pdf" to upload zone
2. FileUploadZone shows uploading indicator
3. ParserSelector analyzes file metadata:
   - Filename: "BofA_Statement_Nov2024.pdf"
   - File type: PDF
4. ParserSelector matches filename pattern ".*BofA.*\.pdf"
5. Auto-selects: parser_bofa_pdf v2.1.0 (confidence: 0.98)
6. User sees success notification:
   ✅ "Auto-detected: Bank of America PDF Parser v2.1.0"
7. File queued for parsing
```

### Wireframe

```
┌──────────────────────────────────────────────────┐
│ Upload Document                                   │
├──────────────────────────────────────────────────┤
│                                                   │
│   ┌─────────────────────────────────────────┐    │
│   │  📄 BofA_Statement_Nov2024.pdf          │    │
│   │  245 KB • PDF                           │    │
│   │                                         │    │
│   │  ✅ Auto-detected:                      │    │
│   │  Bank of America PDF Parser v2.1.0     │    │
│   │  98% confidence                         │    │
│   │                                         │    │
│   │  [Change Parser] [Continue]            │    │
│   └─────────────────────────────────────────┘    │
│                                                   │
└──────────────────────────────────────────────────┘
```

---

## Journey 2: Manual Override (Ambiguous File)

**User Story:** As a user, the auto-detected parser is wrong, so I manually select the correct one.

### Flow

```
1. User uploads "statement.pdf" (no bank indicator)
2. ParserSelector auto-selects: parser_generic_pdf (confidence: 0.55)
3. User sees warning:
   ⚠️ "Detected: Generic PDF Parser (55% confidence)"
4. User clicks "Change Parser"
5. ParserSelectorDialog opens with ranked alternatives:
   - Generic PDF Parser (55%) [current]
   - BofA PDF Parser (40%)
   - Chase PDF Parser (40%)
6. User selects "Chase PDF Parser v1.5.3"
7. Dialog closes, file metadata updated
8. File re-queued for parsing with correct parser
```

### Wireframe

```
┌──────────────────────────────────────────────────┐
│ Select Parser                                  [X]│
├──────────────────────────────────────────────────┤
│ File: statement.pdf                              │
│                                                   │
│ ⚠️ Low confidence - please confirm parser:       │
│                                                   │
│ ┌─────────────────────────────────────────┐      │
│ │ Generic PDF Parser v1.0.0 (Current)     │      │
│ │ 55% confidence                          │      │
│ │ [Select] ✓                              │      │
│ └─────────────────────────────────────────┘      │
│                                                   │
│ ┌─────────────────────────────────────────┐      │
│ │ Chase PDF Parser v1.5.3                 │      │
│ │ 40% confidence                          │      │
│ │ [Select]                                │      │
│ └─────────────────────────────────────────┘      │
│                                                   │
│                          [Cancel] [Continue]      │
└──────────────────────────────────────────────────┘
```

---

## Journey 3: View Parser Capabilities

**User Story:** As a user, I want to see what fields a parser can extract before uploading.

### Flow

```
1. User hovers over "Bank of America PDF Parser v2.1.0"
2. ParserCapabilitiesCard appears (tooltip)
3. Shows capability list:
   ✅ Date (98% confidence)
   ✅ Amount (98% confidence)
   ✅ Merchant (95% confidence)
   ✅ Account (98% confidence)
   ✅ Balance (95% confidence)
   ⚠️  Memo (70% confidence)
   ❌ Category (not supported)
4. User sees exactly what will be extracted
5. User can compare with other parsers before deciding
```

---

## Journey 4: Deprecated Parser Warning

**User Story:** As a user, I'm using an old parser version and need to upgrade.

### Flow

```
1. User uploads file that previously used v1.5.0
2. System checks parser version:
   - v1.5.0 is deprecated (sunset: 2024-12-31)
   - v2.1.0 is latest
3. ParserVersionDropdown shows warning:
   ⚠️ "Deprecated Version"
   Current: v1.5.0 (deprecated - sunset Dec 31, 2024)
   Latest: v2.1.0

   Breaking changes in v2.0.0:
   - Merchant field renamed to counterparty
   - Balance field now required

   [View Migration Guide] [Upgrade to v2.1.0]
4. User clicks "Upgrade to v2.1.0"
5. System applies field mapping (merchant → counterparty)
6. File re-parsed with new version
7. Success: ✅ "Upgraded to v2.1.0 successfully"
```

---

## Journey 5: Admin Registers New Parser

**User Story:** As an admin, I register a new Scotia Bank CSV parser.

### Flow

```
1. Admin opens Parser Management UI
2. Clicks "Register New Parser"
3. Fills registration form:
   - Name: "Scotia Bank CSV Parser"
   - Version: "1.0.0"
   - File Types: CSV
   - Capabilities: date, amount, merchant, account
   - Filename Patterns: .*Scotia.*\.csv, .*Scotiabank.*\.csv
4. System validates:
   ✅ parser_id unique
   ✅ Version format valid (1.0.0)
   ✅ Capabilities exist
5. Creates ParserRegistration with ID "parser_scotia_csv"
6. Parser immediately available for auto-selection
7. Success: ✅ "Parser registered successfully"
```

---

## Journey 6: View Compatibility Matrix

**User Story:** As a user, I compare parsers side-by-side to choose the best one.

### Flow

```
1. User opens "Compare Parsers" page
2. Capability matrix displayed:

   Parser              | date | amount | merchant | balance
   --------------------|------|--------|----------|--------
   parser_bofa_pdf     | 0.98 | 0.98   | 0.95     | 0.95
   parser_chase_pdf    | 0.97 | 0.97   | 0.92     | N/A
   parser_generic_pdf  | 0.80 | 0.85   | 0.70     | 0.40

3. User sees BofA parser has best balance extraction (0.95)
4. User clicks on BofA parser row to see full details
5. ParserCapabilitiesCard expands with all capabilities
```

---

## Multi-Domain Examples

### Healthcare: HL7 Message Auto-Selection

```
File: ADT_A01_20241101.hl7
Auto-detected: HL7 v2.5 ADT Parser v3.0.0 (95% confidence)
Reason: Filename matches '.*ADT.*\.hl7', file type matches
```

### Legal: Court Filing Parser

```
File: CA_Superior_Court_Filing_12345.pdf
Auto-detected: California Court Filing PDF Parser v1.2.0 (92% confidence)
Reason: Filename matches '.*CA.*court.*\.pdf'
```

### Research: BibTeX Citation

```
File: references.bib
Auto-detected: BibTeX Citation Parser v2.0.1 (99% confidence)
Reason: File extension matches '\.bib$'
```

---

## Summary

These 6 user journeys demonstrate:

✅ **Auto-selection** with high confidence (Journey 1)
✅ **Manual override** for ambiguous files (Journey 2)
✅ **Capability transparency** (Journey 3)
✅ **Deprecation handling** (Journey 4)
✅ **Admin workflows** (Journey 5)
✅ **Comparison tools** (Journey 6)

All patterns are **domain-agnostic** and apply to Finance, Healthcare, Legal, Research, and E-commerce domains.
