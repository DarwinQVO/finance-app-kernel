# UX Flow: Vertical 5.2 - Schema Registry Experience

> **Vertical:** 5.2 Schema Registry
> **Focus:** Schema versioning, migration execution, backward compatibility
> **Last Updated:** 2025-10-25

---

## Overview

This document describes the complete user experience for the Schema Registry system, covering schema versioning workflows, migration execution, backward compatibility checking, and multi-domain schema management. The Schema Registry enables data engineers, platform teams, and domain experts to evolve data schemas safely with automated compatibility checks, migration planning, and zero-downtime deployments.

**Key User Personas:**
- **Data Engineer:** Publishes schema versions, executes migrations, monitors compatibility
- **Platform Engineer:** Reviews breaking changes, approves major version bumps, manages rollbacks
- **Domain Expert:** Defines schema requirements, validates field definitions, reviews migrations
- **DevOps Engineer:** Monitors migration progress, manages deployment windows, handles incidents

**Core Workflows:**
1. Publish New Schema Version
2. Detect Breaking Changes
3. Execute Migration with Rollback
4. Compare Schema Versions
5. Approve Breaking Change Request
6. Handle Migration Failure

---

## Journey 1: Publish New Schema Version (Happy Path)

**Persona:** Data Engineer (Sarah)
**Goal:** Publish a backward-compatible minor version (v1.1.0) adding optional "category" field
**Context:** ObservationTransaction schema (Finance domain) needs categorization support

### Steps

**1. Open Schema Editor**
- Sarah navigates to Schema Registry → ObservationTransaction
- System displays current version: v1.0.0 (published 3 months ago)
- Click "Create New Version" button

**2. Edit Schema in Monaco Editor**
- System creates draft based on v1.0.0
- Sarah adds new field in JSON Schema:
```json
"category": {
  "type": "string",
  "description": "Transaction category (e.g., groceries, utilities)",
  "examples": ["groceries", "utilities", "entertainment"]
}
```
- Monaco editor provides autocomplete for JSON Schema keywords
- Real-time validation shows green checkmark

**3. Run Compatibility Check**
- Sarah clicks "Check Compatibility" button
- System runs BackwardCompatibilityChecker.check()
- Results appear in 2.3 seconds:
  - ✅ Backward Compatible
  - Change Type: FIELD_ADDED (optional)
  - Recommended Version: v1.1.0 (MINOR bump)
  - Impact: 0 records require migration
  - Risk Level: LOW

**4. Review Changes**
- CompatibilityViewer shows side-by-side diff:
  - Left: v1.0.0 (3 fields)
  - Right: v1.1.0 (4 fields, "category" highlighted in green)
- Sarah expands "What's changing?" section:
  - Added: 1 optional field
  - Removed: 0 fields
  - Modified: 0 fields

**5. Publish Version**
- Sarah enters changelog: "Add optional category field for transaction categorization"
- Clicks "Publish v1.1.0"
- System validates schema, stores in PostgreSQL with UNIQUE(schema_id, version)
- Success notification: "✅ Published observation-transaction v1.1.0"
- Version appears in version history with green "COMPATIBLE" badge

**6. Verification**
- Sarah clicks "Test with Sample Data"
- System shows that old data (without category) validates against v1.1.0 ✅
- New data (with category) validates against v1.1.0 ✅
- Consumers using v1.0.0 can still read data ✅

**Outcome:** Sarah successfully published a backward-compatible schema version with zero downtime and no migration required.

---

## Journey 2: Detect Breaking Changes (Warning Path)

**Persona:** Data Engineer (Marcus)
**Goal:** Detect breaking changes when attempting to change field type
**Context:** PatientRecord schema (Healthcare domain) needs date format standardization

### Steps

**1. Open Existing Schema**
- Marcus opens PatientRecord v2.0.0 in SchemaEditor
- Current field: `"admission_date": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" }`
- Goal: Change to ISO 8601 datetime for timezone support

**2. Modify Field Type**
- Marcus edits schema:
```json
"admission_date": {
  "type": "string",
  "format": "date-time",
  "description": "ISO 8601 datetime with timezone"
}
```
- Monaco editor shows yellow warning icon next to field

**3. Automatic Compatibility Check**
- System automatically runs check on field change
- Breaking Change Detector analyzes diff in 180ms
- **Warning Modal Appears:**

```
⚠️  BREAKING CHANGE DETECTED

Field: admission_date
Change Type: CONSTRAINT_TIGHTENED
Severity: MAJOR

Impact Analysis:
- Affected Records: 1,234,567 records
- Migration Required: YES
- Estimated Duration: 23 minutes
- Recommended Version: v3.0.0 (MAJOR bump)

Why is this breaking?
Old format (YYYY-MM-DD) does not conform to new format (ISO 8601 datetime).
Existing data like "2025-01-15" will FAIL validation against new schema.

Options:
[Review Impact] [Cancel Change] [Continue Anyway]
```

**4. Review Detailed Impact**
- Marcus clicks "Review Impact"
- CompatibilityViewer shows:
  - Sample failing records: 5 examples from production
  - Migration complexity: MODERATE
  - Rollback strategy: Automatic (shadow tables)
  - Downtime estimate: Zero (with batch migration)

**5. Generate Migration Plan**
- Marcus clicks "Generate Migration Plan"
- MigrationEngine creates plan with 4 steps:
  1. Backup data (1.2M records) - 45 seconds
  2. Create shadow table - 5 seconds
  3. Transform field: `CONCAT(admission_date, 'T00:00:00Z')` - 22 minutes
  4. Cutover with validation - 2.5 seconds
- Total estimated time: 23 minutes

**6. Request Approval**
- Marcus saves draft as v3.0.0-DRAFT
- Clicks "Request Breaking Change Approval"
- System creates approval request for Platform Engineer
- Email sent to platform team with impact summary
- Marcus receives confirmation: "Approval request sent. Version saved as draft."

**Outcome:** Marcus was prevented from accidentally publishing a breaking change. The system detected the issue, quantified the impact, generated a migration plan, and routed to approval workflow.

---

## Journey 3: Execute Migration with Zero Downtime

**Persona:** Platform Engineer (Elena)
**Goal:** Execute approved migration for PatientRecord v2.0.0 → v3.0.0
**Context:** Breaking change approved, migration scheduled for tonight

### Steps

**1. Open Migration Dashboard**
- Elena navigates to Schema Registry → Migrations → Pending
- Sees PatientRecord v2→v3 migration (approved 2 hours ago)
- Status: Scheduled for 02:00 AM (maintenance window)

**2. Review Migration Plan**
- Elena clicks "Review Plan"
- MigrationWizard shows 5-step wizard:

```
Step 1: Pre-Migration Checks       [PENDING]
Step 2: Data Backup                [PENDING]
Step 3: Shadow Table Setup         [PENDING]
Step 4: Batch Transformation       [PENDING]
Step 5: Cutover & Validation       [PENDING]
```

- Each step shows:
  - Estimated duration
  - Affected record count
  - Rollback point indicator

**3. Start Migration**
- Elena clicks "Start Migration Now" (or waits for scheduled time)
- System displays real-time progress:

```
🟢 MIGRATION IN PROGRESS

Schema: patient-record
Version: v2.0.0 → v3.0.0
Started: 2025-10-25 02:00:15
Elapsed: 00:03:42

[████████░░] 82% Complete

Current Step: 4/5 - Batch Transformation
├─ Batch 124/150 (10,000 records/batch)
├─ Records Migrated: 1,240,000 / 1,500,000
├─ Throughput: 14,183 records/sec
├─ Errors: 0
└─ ETA: 00:01:18 remaining

Last Checkpoint: Batch 123 completed successfully
Rollback Available: YES (automatic on failure)

[Pause Migration] [View Logs] [Monitor Health]
```

**4. Monitor Real-Time Metrics**
- Elena opens "Monitor Health" panel:
  - Database CPU: 42% (within limits)
  - Disk I/O: 1,200 IOPS (normal)
  - Application latency: +8ms (acceptable)
  - Error rate: 0.00%
- All systems remain healthy during migration

**5. Cutover Phase**
- System completes batch transformation
- Automatic validation runs on transformed data
- Final cutover begins:

```
🔄 CUTOVER IN PROGRESS

├─ Validating transformed data... ✅ (1.2s)
├─ Swapping shadow table... ✅ (0.8s)
├─ Updating schema registry... ✅ (0.3s)
└─ Publishing v3.0.0 as current... ✅ (0.2s)

Total Cutover Time: 2.5 seconds
```

**6. Completion**
- Success notification appears:

```
✅ MIGRATION COMPLETED SUCCESSFULLY

Schema: patient-record v3.0.0
Duration: 23 minutes 47 seconds
Records Migrated: 1,500,000
Errors: 0
Downtime: 0 seconds (zero-downtime cutover)

Next Steps:
- Monitor application metrics for 1 hour
- Old version (v2.0.0) available for rollback (24 hours)
- Backup stored: backup_20251025_020015

[View Report] [Monitor Applications] [Close]
```

**7. Post-Migration Monitoring**
- Elena monitors applications for 30 minutes
- All systems show normal metrics
- No errors logged
- Migration marked as SUCCESSFUL in registry

**Outcome:** Elena successfully executed a breaking change migration with zero downtime, full observability, and automatic rollback capability.

---

## Journey 4: Rollback Failed Migration

**Persona:** DevOps Engineer (James)
**Goal:** Rollback migration after detecting data validation errors
**Context:** LegalContract schema migration v1→v2 failing validation checks

### Steps

**1. Detect Migration Failure**
- James receives alert at 03:47 AM:

```
🔴 MIGRATION FAILURE DETECTED

Schema: legal-contract
Version: v1.5.0 → v2.0.0
Step Failed: 4/5 - Batch Transformation
Batch: 87/200
Error: Validation failed for 127 records in batch 87

Error Details:
- Field: contract_value
- Issue: Negative values found (invalid for new schema)
- Affected Records: 127 / 10,000 in batch

Migration Status: PAUSED (automatic)
Rollback Available: YES

[View Error Details] [Start Rollback] [Resume Migration]
```

**2. Investigate Error**
- James clicks "View Error Details"
- System shows sample failing records:

```json
{
  "contract_id": "CTR-2024-1847",
  "contract_value": -15000,
  "error": "Field 'contract_value' failed validation: value must be >= 0"
}
```

- Root cause: New schema added `"minimum": 0` constraint
- Issue: Production data has 127 credit memo contracts with negative values

**3. Assess Situation**
- James consults with on-call data engineer
- Decision: Rollback migration, fix schema to allow negative values
- Rollback window: 15 minutes to restore service

**4. Initiate Rollback**
- James clicks "Start Rollback"
- System prompts for confirmation:

```
⚠️  CONFIRM ROLLBACK

This will revert legal-contract to v1.5.0

Rollback Plan:
1. Pause migration (already paused)
2. Restore from shadow table backup
3. Revert schema to v1.5.0
4. Validate data consistency
5. Publish v1.5.0 as current

Estimated Time: 8 minutes
Data Loss: None (all transformed data will be reverted)

Are you sure? This cannot be undone.
[Cancel] [Confirm Rollback]
```

**5. Execute Rollback**
- James clicks "Confirm Rollback"
- Real-time rollback progress:

```
🔄 ROLLBACK IN PROGRESS

[████████░░] 87% Complete

Current Step: 4/5 - Validate Data Consistency
├─ Records restored: 870,000 / 1,000,000
├─ Validation checks: PASSING
├─ Schema reverted to: v1.5.0
└─ ETA: 00:01:02 remaining

Backup Source: shadow_table_20251025_034200
Rollback Started: 03:51:23
Elapsed: 00:06:58

[View Logs] [Monitor Health]
```

**6. Rollback Completion**
- Success after 8 minutes:

```
✅ ROLLBACK COMPLETED SUCCESSFULLY

Schema: legal-contract
Reverted to: v1.5.0
Duration: 8 minutes 14 seconds
Records Restored: 1,000,000
Data Loss: None
Downtime: 0 seconds

Migration Status: FAILED (v2.0.0 not published)
Draft Version: v2.0.0-FAILED (available for editing)

Incident Report: Generated (INC-2025-1025-001)

Recommended Actions:
1. Fix schema validation rules to allow negative values
2. Update migration transformation logic
3. Test with production data subset
4. Re-schedule migration

[View Incident Report] [Edit Failed Version] [Close]
```

**7. Post-Incident**
- James documents incident
- Data engineer fixes schema (allows negative values for credit memos)
- New version v2.1.0 created with corrected validation
- Migration re-scheduled for next window

**Outcome:** James successfully rolled back a failed migration with zero data loss, preserving system integrity and minimizing downtime.

---

## Journey 5: Compare Schema Versions

**Persona:** Domain Expert (Priya)
**Goal:** Compare two schema versions to understand evolution
**Context:** Reviewing ObservationTransaction schema changes from v1.0.0 to v2.3.0

### Steps

**1. Open Version Comparison**
- Priya navigates to Schema Registry → ObservationTransaction
- Clicks "Compare Versions" button
- Selects:
  - Left: v1.0.0 (baseline from 6 months ago)
  - Right: v2.3.0 (current production version)

**2. View Side-by-Side Diff**
- CompatibilityViewer displays:

```
┌─────────────────────────────────────┬─────────────────────────────────────┐
│ v1.0.0 (2025-04-15)                 │ v2.3.0 (2025-10-25)                 │
├─────────────────────────────────────┼─────────────────────────────────────┤
│ Fields: 5                           │ Fields: 9 (+4)                      │
│ Required: 3                         │ Required: 3 (unchanged)             │
│ Optional: 2                         │ Optional: 6 (+4)                    │
├─────────────────────────────────────┼─────────────────────────────────────┤
│ {                                   │ {                                   │
│   "merchant": "string",             │   "merchant": "string",             │
│   "amount": "number",               │   "amount": "number",               │
│   "date": "string (YYYY-MM-DD)"     │   "date": "string (ISO 8601)" ⚠️    │
│                                     │   "category": "string" 🆕           │
│                                     │   "tags": "array<string>" 🆕        │
│                                     │   "notes": "string" 🆕              │
│                                     │   "confidence": "number" 🆕         │
│ }                                   │ }                                   │
└─────────────────────────────────────┴─────────────────────────────────────┘

Legend: 🆕 Added  ⚠️ Modified  🗑️ Removed
```

**3. Review Version History Timeline**
- Priya scrolls to "Version History" section:

```
Timeline: v1.0.0 → v2.3.0 (6 versions, 6 months)

v2.3.0 (2025-10-25) ✅ CURRENT
├─ Added: confidence field for data quality scoring
├─ Type: MINOR (backward compatible)
└─ Migration: Not required

v2.2.0 (2025-09-10)
├─ Added: notes field for manual annotations
├─ Type: MINOR (backward compatible)
└─ Migration: Not required

v2.1.0 (2025-08-05)
├─ Added: tags array for flexible categorization
├─ Type: MINOR (backward compatible)
└─ Migration: Not required

v2.0.0 (2025-06-20) ⚠️ BREAKING
├─ Changed: date format from YYYY-MM-DD to ISO 8601
├─ Type: MAJOR (breaking change)
├─ Migration: Required (1.2M records, 23 minutes)
└─ Reason: Add timezone support for global transactions

v1.1.0 (2025-05-12)
├─ Added: category field for transaction categorization
├─ Type: MINOR (backward compatible)
└─ Migration: Not required

v1.0.0 (2025-04-15) 🎉 INITIAL
└─ Initial schema release
```

**4. Analyze Breaking Changes**
- Priya clicks on v2.0.0 (breaking change)
- System shows detailed migration report:
  - Breaking change: Date format constraint tightened
  - Records affected: 1,234,567
  - Migration duration: 23 minutes
  - Success rate: 100%
  - Rollback performed: No

**5. Export Comparison Report**
- Priya clicks "Export Report"
- System generates PDF with:
  - Schema evolution summary
  - Field-level changes
  - Migration history
  - Impact analysis for each version
- Used for compliance documentation

**Outcome:** Priya gained complete understanding of schema evolution, identifying the single breaking change and validating that all other changes were backward compatible.

---

## Journey 6: Approve Breaking Change Request

**Persona:** Platform Engineer (David)
**Goal:** Review and approve breaking change request for InsuranceClaim schema
**Context:** Data engineer submitted breaking change requiring major version bump

### Steps

**1. Receive Approval Request**
- David receives email:

```
Subject: [Schema Registry] Breaking Change Approval Required

Schema: insurance-claim
Requested Version: v3.0.0 (MAJOR)
Submitted By: Sarah Chen (Data Engineer)
Submitted At: 2025-10-25 14:30

Breaking Changes:
- FIELD_TYPE_CHANGED: claim_amount (string → number)
- REQUIRED_ADDED: policy_number (now required)

Impact:
- Affected Records: 2,456,789
- Migration Required: YES (estimated 45 minutes)
- Downtime: None (zero-downtime migration)

[Review Request] [Approve] [Reject]
```

**2. Open Approval Dashboard**
- David clicks "Review Request"
- System displays approval workflow:

```
🔍 BREAKING CHANGE APPROVAL

Schema: insurance-claim v2.8.0 → v3.0.0
Status: PENDING_APPROVAL
Submitted: 2 hours ago

Breaking Changes Detected: 2

┌──────────────────────────────────────────────────────────────┐
│ Change #1: Field Type Changed                                │
├──────────────────────────────────────────────────────────────┤
│ Field: claim_amount                                          │
│ Old Type: string (e.g., "1500.00")                          │
│ New Type: number (e.g., 1500.00)                            │
│ Reason: Enable numeric calculations and aggregations        │
│ Severity: MAJOR                                              │
│ Impact: 2,456,789 records require transformation            │
│ Risk: LOW (transformation logic validated)                   │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│ Change #2: Required Field Added                              │
├──────────────────────────────────────────────────────────────┤
│ Field: policy_number                                         │
│ Status: Optional → Required                                  │
│ Reason: Enforce referential integrity with Policy table     │
│ Severity: MAJOR                                              │
│ Impact: 47 records missing policy_number (0.002%)           │
│ Risk: MODERATE (requires manual data cleanup)               │
└──────────────────────────────────────────────────────────────┘

[View Migration Plan] [Test with Sample Data] [Approve] [Reject]
```

**3. Review Migration Plan**
- David clicks "View Migration Plan"
- MigrationEngine shows detailed plan:

```
Migration Plan: insurance-claim v2.8.0 → v3.0.0

Total Steps: 6
Estimated Duration: 45 minutes
Rollback Strategy: Shadow tables (automatic)
Maintenance Window Required: No (zero-downtime)

Step 1: Data Quality Check (5 min)
├─ Validate claim_amount string→number conversion
├─ Identify records missing policy_number
└─ Expected Issues: 47 records (manual fix required)

Step 2: Manual Data Cleanup (10 min)
├─ Fix 47 records missing policy_number
└─ Validation: All records must have policy_number

Step 3: Backup (3 min)
└─ Create backup: 2.5M records

Step 4: Shadow Table Setup (2 min)
└─ Create shadow table for zero-downtime migration

Step 5: Batch Transformation (40 min)
├─ Transform claim_amount: parseFloat(value)
├─ Batch size: 10,000 records
├─ Throughput: ~14,000 records/sec
└─ Total batches: 246

Step 6: Cutover & Validation (2 min)
├─ Validate transformed data
├─ Swap shadow table
└─ Publish v3.0.0

Rollback Points:
- After Step 3 (before transformation)
- After Step 5 (before cutover)
```

**4. Test with Sample Data**
- David clicks "Test with Sample Data"
- System runs migration on 1,000 production records (read-only)
- Results appear in 8 seconds:

```
✅ TEST MIGRATION SUCCESSFUL

Records Tested: 1,000 (random sample from production)
Transformations Applied: 2
├─ claim_amount string→number: 1,000/1,000 successful ✅
└─ policy_number validation: 1,000/1,000 passed ✅

Validation Results:
├─ Schema compliance: 100% ✅
├─ Data integrity: 100% ✅
└─ Referential integrity: 100% ✅

Estimated Production Success Rate: 99.998%
(47 records require manual fix before migration)

[View Sample Output] [Re-run Test] [Proceed to Approval]
```

**5. Request Pre-Migration Fix**
- David sees 47 records need manual cleanup
- Clicks "Request Data Cleanup"
- System creates ticket for data engineer:

```
📋 PRE-MIGRATION CLEANUP REQUIRED

Schema: insurance-claim v3.0.0
Issue: 47 records missing required field 'policy_number'

Records: [Export CSV with 47 record IDs]

Action Required:
- Lookup policy_number from claims system
- Update records via API or SQL
- Mark cleanup as complete

Deadline: Before migration window (2025-10-26 02:00)

[Assign to Data Engineer] [Export Record List]
```

**6. Conditional Approval**
- David clicks "Approve with Conditions"
- Approval modal appears:

```
✅ APPROVE BREAKING CHANGE

Approval Type:
( ) Unconditional - Approve immediately
(•) Conditional - Requires pre-migration tasks

Pre-Migration Requirements:
☑ Fix 47 records missing policy_number
☑ Run test migration on staging environment
☑ Schedule during maintenance window (02:00-04:00)

Approval Comments:
┌──────────────────────────────────────────────────────┐
│ Approved pending data cleanup. Strong justification  │
│ for breaking change (enable numeric calculations).   │
│ Migration plan is solid with proper rollback.        │
│                                                      │
│ Data engineer: Please complete cleanup by EOD.      │
│ DevOps: Monitor closely during migration window.    │
└──────────────────────────────────────────────────────┘

[Cancel] [Approve with Conditions]
```

**7. Approval Confirmation**
- David clicks "Approve with Conditions"
- System confirms:

```
✅ BREAKING CHANGE APPROVED

Schema: insurance-claim v3.0.0
Approval Type: CONDITIONAL
Approved By: David Martinez (Platform Engineer)
Approved At: 2025-10-25 16:45

Pre-Migration Tasks:
1. Data cleanup (47 records) - Assigned to Sarah Chen
2. Staging test - Assigned to DevOps
3. Schedule migration - 2025-10-26 02:00

Status: APPROVED (pending pre-migration tasks)

Notifications Sent:
- Sarah Chen (Data Engineer) - Data cleanup task
- DevOps Team - Staging test & scheduling
- Platform Team - Approval confirmation

[View Approval Record] [Track Pre-Migration Tasks] [Close]
```

**8. Track Progress**
- David monitors pre-migration task dashboard:

```
Pre-Migration Tasks: insurance-claim v3.0.0

Task 1: Data Cleanup ✅ COMPLETED (2025-10-25 18:30)
├─ 47 records fixed
├─ Validated by: Sarah Chen
└─ Status: Ready for migration

Task 2: Staging Test ✅ COMPLETED (2025-10-25 20:15)
├─ 100% success rate on staging data
├─ Validated by: DevOps Team
└─ Status: Passed

Task 3: Migration Scheduled 🕒 SCHEDULED
├─ Window: 2025-10-26 02:00 - 04:00
├─ On-call: DevOps rotation
└─ Status: Pending execution

Overall Status: READY FOR MIGRATION ✅
```

**Outcome:** David successfully reviewed and approved a breaking change with appropriate safeguards, ensuring data quality through conditional approval and pre-migration validation.

---

## Wireframes

### Wireframe 1: Schema Editor (Main View)

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Schema Registry → observation-transaction                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Current Version: v1.0.0                Last Updated: 2025-04-15       │
│  Status: ✅ Published                    Published By: sarah_chen       │
│                                                                         │
│  [Compare Versions] [Create New Version] [View History] [Deprecate]    │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  📝 Schema Definition (Monaco Editor)                                   │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │ {                                                                 │ │
│  │   "$schema": "http://json-schema.org/draft-07/schema#",          │ │
│  │   "type": "object",                                              │ │
│  │   "properties": {                                                │ │
│  │     "merchant": {                                                │ │
│  │       "type": "string",                                          │ │
│  │       "description": "Merchant name"                             │ │
│  │     },                                                           │ │
│  │     "amount": {                                                  │ │
│  │       "type": "number",                                          │ │
│  │       "minimum": 0                                               │ │
│  │     },                                                           │ │
│  │     "date": {                                                    │ │
│  │       "type": "string",                                          │ │
│  │       "pattern": "^\\d{4}-\\d{2}-\\d{2}$"                        │ │
│  │     },                                                           │ │
│  │     "category": {  ← NEW FIELD                                  │ │
│  │       "type": "string",                                          │ │
│  │       "description": "Transaction category"                      │ │
│  │     }                                                            │ │
│  │   },                                                             │ │
│  │   "required": ["merchant", "amount", "date"]                     │ │
│  │ }                                                                │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  ✅ Valid JSON Schema  |  4 fields  |  3 required  |  1 optional       │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  🔍 Compatibility Check                                                 │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Status: ✅ Backward Compatible                                   │ │
│  │                                                                   │ │
│  │  Change Summary:                                                 │ │
│  │  • Added: 1 optional field (category)                           │ │
│  │  • Removed: 0 fields                                             │ │
│  │  • Modified: 0 fields                                            │ │
│  │                                                                   │ │
│  │  Recommended Version: v1.1.0 (MINOR bump)                        │ │
│  │  Migration Required: NO                                          │ │
│  │  Risk Level: LOW                                                 │ │
│  │                                                                   │ │
│  │  [View Detailed Report]                                          │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  📝 Changelog                                                           │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │ Add optional category field for transaction categorization       │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│                                   [Cancel] [Publish v1.1.0]            │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 2: Compatibility Viewer (Side-by-Side Diff)

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Compare Versions: observation-transaction                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Left: v1.0.0 (2025-04-15)    Right: v1.1.0 (2025-10-25)              │
│  [Select Version ▾]             [Select Version ▾]                      │
│                                                                         │
├─────────────────────────────────┬───────────────────────────────────────┤
│                                 │                                       │
│  v1.0.0                         │  v1.1.0                               │
│                                 │                                       │
│  {                              │  {                                    │
│    "type": "object",            │    "type": "object",                  │
│    "properties": {              │    "properties": {                    │
│      "merchant": {              │      "merchant": {                    │
│        "type": "string"         │        "type": "string"               │
│      },                         │      },                               │
│      "amount": {                │      "amount": {                      │
│        "type": "number"         │        "type": "number"               │
│      },                         │      },                               │
│      "date": {                  │      "date": {                        │
│        "type": "string"         │        "type": "string"               │
│      }                          │      },                               │
│                                 │ +    "category": {        [GREEN]    │
│                                 │ +      "type": "string"   [GREEN]    │
│                                 │ +    }                    [GREEN]    │
│    },                           │    },                                 │
│    "required": [                │    "required": [                      │
│      "merchant",                │      "merchant",                      │
│      "amount",                  │      "amount",                        │
│      "date"                     │      "date"                           │
│    ]                            │    ]                                  │
│  }                              │  }                                    │
│                                 │                                       │
│  Fields: 3                      │  Fields: 4 (+1)                       │
│  Required: 3                    │  Required: 3 (unchanged)              │
│  Optional: 0                    │  Optional: 1 (+1)                     │
│                                 │                                       │
└─────────────────────────────────┴───────────────────────────────────────┘
│                                                                         │
│  📊 Change Summary                                                      │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  ✅ Backward Compatible                                           │ │
│  │                                                                   │ │
│  │  🆕 Added (1):                                                    │ │
│  │    • category (string, optional)                                 │ │
│  │                                                                   │ │
│  │  🗑️ Removed (0): None                                             │ │
│  │                                                                   │ │
│  │  ⚠️ Modified (0): None                                            │ │
│  │                                                                   │ │
│  │  Version Bump: v1.0.0 → v1.1.0 (MINOR)                           │ │
│  │  Migration Required: NO                                          │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│                                             [Export Report] [Close]     │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 3: Migration Wizard (Step 1 - Pre-Checks)

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Migration Wizard: patient-record v2.0.0 → v3.0.0                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Progress: Step 1 of 5                                                 │
│  [████░░░░░░░░░░░] 20%                                                 │
│                                                                         │
│  1. Pre-Migration Checks  ← YOU ARE HERE                               │
│  2. Data Backup                                                        │
│  3. Shadow Table Setup                                                 │
│  4. Batch Transformation                                               │
│  5. Cutover & Validation                                               │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  🔍 Pre-Migration Checks                                                │
│                                                                         │
│  Running validation checks before migration...                         │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  ✅ Database connectivity            [PASSED]                     │ │
│  │  ✅ Schema exists (v2.0.0)            [PASSED]                     │ │
│  │  ✅ Target schema valid (v3.0.0)      [PASSED]                     │ │
│  │  ✅ Disk space available              [PASSED] (150 GB free)      │ │
│  │  ✅ Record count verified             [PASSED] (1,500,000)        │ │
│  │  ⚠️  Data quality check               [WARNING]                   │ │
│  │     • 127 records have negative values in contract_value         │ │
│  │     • New schema requires contract_value >= 0                    │ │
│  │     • Action: Fix or exclude these records                       │ │
│  │                                                                   │ │
│  │  [View Problem Records] [Exclude Records] [Cancel Migration]     │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  ⚠️  WARNING: Data Quality Issues Detected                             │
│                                                                         │
│  127 records will fail validation with new schema. Options:            │
│                                                                         │
│  ( ) Fix records before migration (recommended)                        │
│      Export CSV, fix data, re-import, re-run checks                   │
│                                                                         │
│  ( ) Exclude invalid records from migration                            │
│      Records will remain in old schema, require manual review          │
│                                                                         │
│  ( ) Modify schema to allow negative values                            │
│      Update v3.0.0 draft to allow negative contract_value             │
│                                                                         │
│                                                                         │
│                                      [Back] [Fix Data] [Continue]      │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 4: Migration Progress (Real-Time)

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Migration In Progress: patient-record v2.0.0 → v3.0.0                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  🟢 MIGRATION RUNNING                                                   │
│                                                                         │
│  Started: 2025-10-25 02:00:15                                          │
│  Elapsed: 00:18:42                                                     │
│  ETA: 00:04:18 remaining                                               │
│                                                                         │
│  Overall Progress:                                                     │
│  [████████████████░░░░] 82%                                            │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Current Step: 4/5 - Batch Transformation                              │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Batch: 124 / 150                                                │ │
│  │  [████████████████░░░] 82.7%                                     │ │
│  │                                                                   │ │
│  │  Records Migrated:    1,240,000 / 1,500,000                      │ │
│  │  Throughput:          14,183 records/sec                         │ │
│  │  Batch Size:          10,000 records                             │ │
│  │  Errors:              0                                          │ │
│  │  Warnings:            0                                          │ │
│  │                                                                   │ │
│  │  Last Checkpoint: Batch 123 completed at 02:18:39               │ │
│  │  Rollback Available: YES (automatic on failure)                  │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  📊 System Health                                                       │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Database CPU:     42% [████████░░░░░░░░░░░░] Normal             │ │
│  │  Disk I/O:         1,200 IOPS                Normal             │ │
│  │  App Latency:      +8ms                     Acceptable          │ │
│  │  Error Rate:       0.00%                    Healthy             │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  📝 Recent Activity Log                                                 │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  02:18:39  Batch 123 completed (10,000 records)                  │ │
│  │  02:18:37  Batch 122 completed (10,000 records)                  │ │
│  │  02:18:35  Batch 121 completed (10,000 records)                  │ │
│  │  02:18:32  Checkpoint created (batch 120)                        │ │
│  │  02:18:30  Batch 120 completed (10,000 records)                  │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│                      [Pause Migration] [View Full Logs] [Monitor]      │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 5: Breaking Change Warning Modal

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    ⚠️  BREAKING CHANGE DETECTED                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  The change you made will break backward compatibility.                │
│                                                                         │
│  Field: admission_date                                                 │
│  Change Type: CONSTRAINT_TIGHTENED                                     │
│  Severity: MAJOR                                                       │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  OLD (v2.0.0):                                                    │ │
│  │  "admission_date": {                                             │ │
│  │    "type": "string",                                             │ │
│  │    "pattern": "^\\d{4}-\\d{2}-\\d{2}$"                           │ │
│  │  }                                                               │ │
│  │                                                                   │ │
│  │  NEW (v3.0.0):                                                    │ │
│  │  "admission_date": {                                             │ │
│  │    "type": "string",                                             │ │
│  │    "format": "date-time"    ← ISO 8601 datetime                 │ │
│  │  }                                                               │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  📊 Impact Analysis                                                     │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Affected Records:     1,234,567 records                         │ │
│  │  Migration Required:   YES                                       │ │
│  │  Estimated Duration:   23 minutes                                │ │
│  │  Downtime:            0 seconds (zero-downtime migration)       │ │
│  │  Recommended Version:  v3.0.0 (MAJOR bump)                       │ │
│  │                                                                   │ │
│  │  Why is this breaking?                                           │ │
│  │  Old format (YYYY-MM-DD) does not conform to new format         │ │
│  │  (ISO 8601 datetime). Existing data like "2025-01-15" will     │ │
│  │  FAIL validation against new schema.                            │ │
│  │                                                                   │ │
│  │  Example failing record:                                         │ │
│  │  {                                                               │ │
│  │    "patient_id": "PAT-12345",                                   │ │
│  │    "admission_date": "2025-01-15"  ← Will fail validation      │ │
│  │  }                                                               │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  What do you want to do?                                               │
│                                                                         │
│  [Generate Migration Plan]  Review automated migration strategy       │
│  [Revert Change]            Undo this change and keep v2.0.0          │
│  [Request Approval]         Save draft and request platform approval   │
│                                                                         │
│                                                       [Cancel]          │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 6: Version History Timeline

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Version History: observation-transaction                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  📅 Timeline View                      [List View] [Graph View]         │
│                                                                         │
│  v2.3.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ ✅ CURRENT          │
│  ┃     Oct 25, 2025                                                    │
│  ┃     Published by: sarah_chen                                        │
│  ┃     Type: MINOR (backward compatible)                               │
│  ┃                                                                      │
│  ┗━━━ Added: confidence field for data quality scoring                 │
│       Migration: Not required                                          │
│       [View Details] [Compare to Previous]                             │
│                                                                         │
│                                                                         │
│  v2.2.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━         │
│  ┃     Sep 10, 2025                                                    │
│  ┃     Published by: marcus_wright                                     │
│  ┃     Type: MINOR (backward compatible)                               │
│  ┃                                                                      │
│  ┗━━━ Added: notes field for manual annotations                        │
│       Migration: Not required                                          │
│       [View Details]                                                   │
│                                                                         │
│                                                                         │
│  v2.1.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━         │
│  ┃     Aug 5, 2025                                                     │
│  ┃     Published by: priya_sharma                                      │
│  ┃     Type: MINOR (backward compatible)                               │
│  ┃                                                                      │
│  ┗━━━ Added: tags array for flexible categorization                    │
│       Migration: Not required                                          │
│       [View Details]                                                   │
│                                                                         │
│                                                                         │
│  v2.0.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ ⚠️      │
│  ┃     Jun 20, 2025                       BREAKING CHANGE             │
│  ┃     Published by: elena_rodriguez                                   │
│  ┃     Type: MAJOR (breaking)                                          │
│  ┃                                                                      │
│  ┗━━━ Changed: date format from YYYY-MM-DD to ISO 8601 datetime        │
│       Reason: Add timezone support for global transactions             │
│       Migration: Required (1.2M records, 23 min, 100% success)         │
│       [View Details] [View Migration Report]                           │
│                                                                         │
│                                                                         │
│  v1.1.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━         │
│  ┃     May 12, 2025                                                    │
│  ┃     Published by: sarah_chen                                        │
│  ┃     Type: MINOR (backward compatible)                               │
│  ┃                                                                      │
│  ┗━━━ Added: category field for transaction categorization             │
│       Migration: Not required                                          │
│       [View Details]                                                   │
│                                                                         │
│                                                                         │
│  v1.0.0 ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 🎉     │
│       Apr 15, 2025                          INITIAL RELEASE            │
│       Published by: data_team                                          │
│                                                                         │
│       Initial schema version for transaction observations              │
│       [View Details]                                                   │
│                                                                         │
│                                                                         │
│  📊 Summary: 6 versions over 6 months                                   │
│     • MAJOR versions: 1 (breaking changes)                             │
│     • MINOR versions: 4 (backward compatible additions)                │
│     • PATCH versions: 0 (bug fixes only)                               │
│     • Total migrations: 1 (v2.0.0)                                     │
│                                                                         │
│                                    [Export Timeline] [Compare Any Two] │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 7: Approval Dashboard (Platform Engineer View)

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Schema Registry → Approvals                                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  🔍 Breaking Change Approvals                [All] [Pending] [Approved] │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  🟡 PENDING APPROVAL                                              │ │
│  │                                                                   │ │
│  │  Schema: insurance-claim                                         │ │
│  │  Version: v2.8.0 → v3.0.0 (MAJOR)                                │ │
│  │  Submitted: 2 hours ago by Sarah Chen                           │ │
│  │                                                                   │ │
│  │  Breaking Changes:                                               │ │
│  │  • FIELD_TYPE_CHANGED: claim_amount (string → number)           │ │
│  │  • REQUIRED_ADDED: policy_number                                │ │
│  │                                                                   │ │
│  │  Impact: 2,456,789 records | Migration: 45 min | Risk: LOW     │ │
│  │                                                                   │ │
│  │  [Review Details] [Approve] [Reject]                            │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  🟢 APPROVED (Scheduled)                                          │ │
│  │                                                                   │ │
│  │  Schema: patient-record                                          │ │
│  │  Version: v2.0.0 → v3.0.0 (MAJOR)                                │ │
│  │  Approved: 8 hours ago by David Martinez                        │ │
│  │  Migration: Scheduled for Oct 26, 02:00                         │ │
│  │                                                                   │ │
│  │  Breaking Changes:                                               │ │
│  │  • CONSTRAINT_TIGHTENED: admission_date (date → datetime)       │ │
│  │                                                                   │ │
│  │  Status: Pre-migration tasks complete ✅                         │ │
│  │                                                                   │ │
│  │  [View Approval] [Reschedule] [Cancel]                          │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  🔴 REJECTED                                                      │ │
│  │                                                                   │ │
│  │  Schema: legal-contract                                          │ │
│  │  Version: v1.5.0 → v2.0.0 (MAJOR)                                │ │
│  │  Rejected: Yesterday by Elena Torres                            │ │
│  │                                                                   │ │
│  │  Rejection Reason:                                               │ │
│  │  "Insufficient justification for breaking change. Removing      │ │
│  │  'contract_type' field will break 15 downstream applications.   │ │
│  │  Please explore backward-compatible alternatives."              │ │
│  │                                                                   │ │
│  │  [View Details] [Resubmit]                                      │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  📊 Approval Statistics (Last 30 days)                                  │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Total Requests:     18                                          │ │
│  │  Approved:           14 (78%)                                    │ │
│  │  Rejected:           3 (17%)                                     │ │
│  │  Pending:            1 (5%)                                      │ │
│  │                                                                   │ │
│  │  Avg Approval Time:  4.2 hours                                   │ │
│  │  Migration Success:  100% (14/14 successful)                     │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### Wireframe 8: Migration Rollback Confirmation

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      ⚠️  CONFIRM MIGRATION ROLLBACK                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Schema: legal-contract                                                │
│  Current Migration: v1.5.0 → v2.0.0                                    │
│  Status: FAILED (Step 4 - Batch Transformation)                        │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Migration Failure Details:                                       │ │
│  │                                                                   │ │
│  │  Failed At: 2025-10-25 03:47:23                                  │ │
│  │  Step: 4/5 - Batch Transformation                                │ │
│  │  Batch: 87/200                                                   │ │
│  │  Error: Validation failed for 127 records in batch 87           │ │
│  │                                                                   │ │
│  │  Root Cause:                                                     │ │
│  │  Field 'contract_value' has negative values in production data  │ │
│  │  New schema requires contract_value >= 0 (constraint added)     │ │
│  │                                                                   │ │
│  │  Records Affected: 127 / 10,000 in failed batch                 │ │
│  │  Records Migrated Before Failure: 860,000                        │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  🔄 Rollback Plan                                                       │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  This will revert legal-contract to v1.5.0                       │ │
│  │                                                                   │ │
│  │  Steps:                                                          │ │
│  │  1. Pause migration (already paused automatically)               │ │
│  │  2. Restore from shadow table backup                             │ │
│  │  3. Revert schema to v1.5.0                                      │ │
│  │  4. Validate data consistency                                    │ │
│  │  5. Publish v1.5.0 as current version                            │ │
│  │                                                                   │ │
│  │  Estimated Time: 8 minutes                                       │ │
│  │  Data Loss: None (all data will be restored to pre-migration)   │ │
│  │  Downtime: 0 seconds (zero-downtime rollback)                   │ │
│  │                                                                   │ │
│  │  Backup Source:                                                  │ │
│  │  • Shadow table: shadow_legal_contract_20251025_034200          │ │
│  │  • Created: 2025-10-25 03:42:00                                 │ │
│  │  • Size: 1.2 GB (1,000,000 records)                             │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  ⚠️  WARNING: This action cannot be undone                             │
│                                                                         │
│  After rollback:                                                       │
│  • Schema will revert to v1.5.0                                        │
│  • All transformed data (860,000 records) will be reverted             │
│  • v2.0.0 will remain as FAILED draft for debugging                    │
│  • Incident report will be generated                                   │
│                                                                         │
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  Incident Report Preview:                                        │ │
│  │  • Incident ID: INC-2025-1025-001                                │ │
│  │  • Root Cause: Schema validation constraint too strict          │ │
│  │  • Recommendation: Allow negative values for credit memos       │ │
│  │  • Action Items: Update schema, re-test, re-schedule            │ │
│  └───────────────────────────────────────────────────────────────────┘ │
│                                                                         │
│  Do you want to proceed with rollback?                                 │
│                                                                         │
│                                          [Cancel] [Confirm Rollback]   │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Multi-Domain Examples

### Finance: Payment Processing Schema Evolution

**Domain:** Fintech payment platform
**Schema:** payment-transaction
**Evolution:** v1.0.0 → v2.0.0 (add multi-currency support)

**Use Case:**
- Initial schema: Single currency (USD) only
- New requirement: Support 150+ currencies for global expansion
- Breaking change: Add required "currency_code" field (ISO 4217)

**User Journey:**
1. Data engineer creates v2.0.0 draft with required "currency_code" field
2. Compatibility checker flags BREAKING CHANGE (required field added)
3. Migration plan generated: Backfill USD for existing 50M transactions
4. Platform engineer approves with conditional data backfill
5. Migration executes in 4.5 hours (batch size: 50K records)
6. Zero downtime achieved via shadow table cutover

**Outcome:** Successfully deployed multi-currency support with 100% backward compatibility for historical data.

---

### Healthcare: HIPAA-Compliant Patient Record Schema

**Domain:** Hospital EHR system
**Schema:** patient-record
**Evolution:** v1.0.0 → v1.1.0 (add consent tracking)

**Use Case:**
- HIPAA compliance requires explicit patient consent tracking
- Add optional "consent_status" and "consent_date" fields
- Backward compatible: Existing records without consent remain valid

**User Journey:**
1. Compliance officer requests new consent fields
2. Data engineer adds two optional fields in v1.1.0
3. Compatibility checker confirms BACKWARD COMPATIBLE
4. No migration required (optional fields)
5. Published immediately to production (5 seconds)
6. Applications gradually adopt consent tracking over 3 months

**Outcome:** HIPAA compliance achieved without breaking existing integrations.

---

### Legal: Contract Management Schema

**Domain:** Legal tech SaaS platform
**Schema:** legal-contract
**Evolution:** v1.5.0 → v2.0.0 (standardize date formats)

**Use Case:**
- Legacy schema used inconsistent date formats (YYYY-MM-DD, MM/DD/YYYY)
- New schema enforces ISO 8601 datetime for global consistency
- Breaking change: Existing dates must be transformed

**User Journey:**
1. Data engineer creates v2.0.0 with strict datetime validation
2. Compatibility checker detects CONSTRAINT_TIGHTENED
3. Sample migration test discovers 127 records with negative values (credit memos)
4. Migration fails validation in batch 87
5. DevOps engineer triggers automatic rollback (8 minutes)
6. Schema revised to allow negative values for refunds
7. v2.1.0 published successfully after fixing validation rules

**Outcome:** Schema evolution prevented data corruption through automated rollback.

---

### Research: Scientific Data Schema

**Domain:** Academic research platform
**Schema:** observation-experiment
**Evolution:** v3.0.0 → v4.0.0 (add statistical metadata)

**Use Case:**
- Research reproducibility requires statistical test metadata
- Add "statistical_method", "p_value", "confidence_interval" fields
- All fields optional (not all experiments use statistics)

**User Journey:**
1. Research data engineer proposes v4.0.0 with 3 new optional fields
2. Compatibility checker confirms BACKWARD COMPATIBLE
3. Schema includes extensive documentation with examples from 5 domains:
   - Clinical trials: p-values from t-tests
   - Physics experiments: confidence intervals from regression
   - Social science: chi-square test results
4. Published to schema registry with zero migration
5. Research teams adopt over 6 months as needed

**Outcome:** Enhanced data quality without disrupting existing research workflows.

---

### E-commerce: Product Catalog Schema

**Domain:** Multi-vendor marketplace
**Schema:** product-listing
**Evolution:** v2.0.0 → v3.0.0 (add variant support)

**Use Case:**
- Enable product variants (size, color) for fashion marketplace
- Breaking change: Restructure "price" to "variants[].price"
- Affects 15M product listings across 50K merchants

**User Journey:**
1. Product team requests variant support for Q4 launch
2. Data engineer creates v3.0.0 with nested variants structure
3. Compatibility checker identifies MAJOR breaking change (field restructured)
4. Migration plan: Transform flat products into single-variant format
5. Platform engineer requests approval with 2-week notice to merchants
6. Automated migration runs over weekend (6 hours for 15M records)
7. Merchant dashboard updated to support variant editing
8. Zero downtime via blue-green deployment

**Outcome:** Successful schema evolution enabled critical business feature for holiday season.

---

### SaaS: Multi-Tenant User Schema

**Domain:** B2B SaaS platform
**Schema:** user-account
**Evolution:** v1.0.0 → v1.5.0 (add SSO support)

**Use Case:**
- Enterprise customers require SAML/OAuth SSO integration
- Add optional "sso_provider", "external_id", "saml_attributes" fields
- Backward compatible: Non-enterprise users unaffected

**User Journey:**
1. Engineering team proposes SSO fields for enterprise tier
2. Schema editor validates JSON Schema with SSO examples
3. Compatibility checker confirms NO MIGRATION REQUIRED
4. Version published to production in < 10 seconds
5. Enterprise customers opt-in to SSO over 3 months
6. Legacy password authentication remains available

**Outcome:** Enterprise feature deployed without impacting 2M existing users.

---

### Insurance: Claims Processing Schema

**Domain:** Insurance claims platform
**Schema:** insurance-claim
**Evolution:** v2.8.0 → v3.0.0 (enforce policy linkage)

**Use Case:**
- Enforce referential integrity between claims and policies
- Breaking change: Make "policy_number" required (was optional)
- Data cleanup required: 47 orphaned claims without policy linkage

**User Journey:**
1. Data engineer creates v3.0.0 with required policy_number
2. Compatibility checker flags BREAKING CHANGE (required field added)
3. Pre-migration validation detects 47 orphaned claims
4. Platform engineer approves with conditional data cleanup
5. Data engineer backfills policy_number for 47 claims (manual review)
6. Migration wizard re-runs pre-checks: ALL PASSED ✅
7. Migration executes successfully (2.5M claims, 45 minutes)
8. Referential integrity enforced going forward

**Outcome:** Data quality improved through enforced schema constraints.

---

## Accessibility Considerations

**Schema Editor (Monaco):**
- Keyboard navigation: Full keyboard support for code editing (Ctrl+Space autocomplete)
- Screen readers: ARIA labels for all editor regions, line numbers announced
- Color contrast: Syntax highlighting meets WCAG AA (4.5:1 contrast ratio)
- Zoom support: Text scales to 200% without horizontal scrolling

**Compatibility Viewer:**
- Diff visualization: Multiple indicators (color, icon, text label) for changes
- Not reliant on color alone: Green "ADDED", Red "REMOVED", Yellow "MODIFIED" with icons
- Screen reader: Changes announced as "Added 3 fields, Removed 1 field, Modified 2 fields"
- Keyboard navigation: Tab through change summary, arrow keys for diff sections

**Migration Wizard:**
- Progress indicators: Visual progress bar + percentage + text status
- Step navigation: Breadcrumb trail with current step highlighted
- Error states: Clear error messages with actionable next steps
- Pause/Resume: Ability to pause long-running migrations for breaks

**Approval Dashboard:**
- Status badges: Color + icon + text (not color alone) for "Pending", "Approved", "Rejected"
- Sort/Filter: Keyboard accessible dropdowns for filtering requests
- Notification: Email + in-app notifications for approval requests
- Documentation links: Inline help text with links to schema documentation

**Real-Time Migration Progress:**
- Live regions: ARIA live regions announce progress updates for screen readers
- Refresh rate: Updates every 2 seconds to avoid overwhelming assistive tech
- Pause option: Ability to pause updates for users needing time to process info
- Export logs: Download logs for offline review

---

## Performance Characteristics

**Schema Editor:**
- Monaco load time: <800ms for JSON Schema up to 5KB
- Autocomplete response: <50ms for keyword suggestions
- Real-time validation: <200ms for schemas up to 100 fields
- Syntax highlighting: 60 FPS rendering for smooth scrolling

**Compatibility Checker:**
- Small schemas (10-20 fields): <100ms analysis time
- Medium schemas (50-100 fields): <380ms analysis time (p95)
- Large schemas (200+ fields): <1.2s analysis time
- Database query: <3ms to fetch latest version (indexed on schema_id)

**Migration Execution:**
- Throughput: 14,000-16,000 records/sec (batch processing)
- 1M records: ~23 minutes total (including validation)
- 10M records: ~3.8 hours total (parallelizable across tables)
- Cutover time: <2.5s for schema swap (zero-downtime)

**Rollback Performance:**
- Small datasets (<1M records): <5 minutes rollback time
- Medium datasets (1-5M records): <15 minutes rollback time
- Large datasets (10M+ records): <45 minutes rollback time
- Data loss: 0% (full restoration from shadow tables)

**Version History Query:**
- List versions: <10ms for schema with 50 versions
- Compare two versions: <150ms for diff calculation
- Timeline view: <250ms to render 100+ versions with metadata

---

## Edge Cases

**Edge Case 1: Circular Migration Dependencies**
- **Scenario:** Schema A v2 depends on Schema B v2, Schema B v2 depends on Schema A v2
- **Detection:** Migration planner detects cycle during dependency graph construction
- **Resolution:** Error shown: "Circular dependency detected. Please migrate Schema A and B together."
- **Workaround:** Combined migration plan that migrates both schemas atomically

**Edge Case 2: Zero Records in Production**
- **Scenario:** New schema published, but no data exists yet
- **Behavior:** Migration skipped, schema version published immediately
- **Validation:** Pre-migration check returns "0 records affected, no migration required"
- **User notification:** "Schema published successfully. No migration needed (table empty)."

**Edge Case 3: Schema Deleted Mid-Migration**
- **Scenario:** Admin deletes schema while migration in progress
- **Protection:** Migration engine acquires row-level lock on schema_version record
- **Behavior:** Delete blocked with error "Cannot delete schema during active migration"
- **Resolution:** Admin must wait for migration completion or trigger rollback first

**Edge Case 4: Multiple Concurrent Migrations**
- **Scenario:** Two engineers attempt to migrate same schema simultaneously
- **Protection:** PostgreSQL UNIQUE constraint on (schema_id, version) prevents duplicate versions
- **Behavior:** Second migration fails with "Version v2.0.0 already published"
- **Resolution:** Second engineer must create v2.1.0 instead, or coordinate with first engineer

**Edge Case 5: Breaking Change Approved but Data Changed**
- **Scenario:** Breaking change approved with impact analysis "1M records". During migration, data grows to 5M records.
- **Behavior:** Migration detects record count mismatch during pre-check
- **User notification:** "Record count changed since approval. Re-run impact analysis?"
- **Options:** [Re-analyze] [Continue Anyway] [Cancel Migration]

**Edge Case 6: Rollback After Partial Cutover**
- **Scenario:** Cutover starts (2.5s window), application reads mix of old/new schema
- **Protection:** Shadow table swap is atomic at database level
- **Behavior:** Applications may see brief inconsistency during swap
- **Mitigation:** Circuit breaker pauses writes for 2.5s during cutover
- **Retry logic:** Applications retry failed reads automatically

**Edge Case 7: Schema Registry Down During Migration**
- **Scenario:** Schema registry API becomes unavailable mid-migration
- **Protection:** Migration engine operates independently (doesn't require registry API)
- **Behavior:** Migration continues, but status updates not visible in UI
- **Recovery:** Status syncs automatically when registry API restored
- **Monitoring:** Alerts sent to DevOps if registry unreachable for >5 minutes

**Edge Case 8: Deprecated Version Still in Use**
- **Scenario:** v1.0.0 deprecated, but 15% of applications still reference it
- **Protection:** Deprecated versions remain readable indefinitely
- **Behavior:** Deprecation warning shown in UI: "This version is deprecated. Migrate to v2.0.0."
- **Enforcement:** Cannot create NEW data with deprecated version (writes rejected)
- **Migration path:** Automated migration available to upgrade to current version

---

## Conclusion

The Schema Registry provides a comprehensive user experience for managing schema evolution across multi-domain data systems. Key UX principles:

1. **Safety-First:** Breaking changes are detected automatically and routed through approval workflows
2. **Zero Downtime:** Shadow table migrations enable schema evolution without application interruptions
3. **Observability:** Real-time progress, health metrics, and detailed logs provide full visibility
4. **Rollback Confidence:** Automatic rollback on failure with zero data loss guarantees
5. **Multi-Domain Applicability:** Same UX patterns apply to Finance, Healthcare, Legal, Research, E-commerce, SaaS, and Insurance domains

The system balances developer velocity (quick publication of compatible changes) with platform stability (rigorous review of breaking changes), enabling data-intensive applications to evolve schemas safely at scale.
