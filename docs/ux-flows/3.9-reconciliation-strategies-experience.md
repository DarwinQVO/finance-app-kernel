# UX Flow 3.9: Reconciliation Strategies Experience

> **Vertical:** 3.9 Reconciliation Strategies (Multi-Source Matching)
> **Dependencies:** 1.3 Normalization (items must be normalized first), ReconciliationEngine (auto-matching), ReconciliationStore (match persistence), ThresholdManager (confidence thresholds)
> **User Story:** As a user, I want to reconcile items from two different sources (bank statements vs ledger, claims vs payments, orders vs shipments) so I can identify matched items, spot discrepancies, and ensure data consistency across systems.

---

## Introduction

### Feature Overview

The Reconciliation Strategies feature enables users to match items from two different data sources, solving critical data quality problems:

**Without Reconciliation:**
- No visibility into which items match across sources
- Manual comparison is error-prone and time-consuming
- Unmatched items go unnoticed (missing transactions, orphaned records)
- No confidence scores to prioritize review efforts
- Cannot handle one-to-many or many-to-one relationships (split payments)

**With Reconciliation:**
- Auto-matching identifies 80%+ of matches without manual work
- Confidence-based tiers (high/medium/low) prioritize user attention
- Unmatched items clearly flagged for investigation
- One-to-many and many-to-one cardinality supported
- Full audit trail for data lineage and compliance

### User Value Proposition

**Time Savings:**
- Auto-detection matches 80-95% of items (depending on data quality)
- Batch accept high-confidence matches (≥95%) with one click
- Focused review only on medium/low confidence suggestions

**Accuracy Gains:**
- Confidence scoring prevents false positives
- Feature-level breakdown shows why matches were suggested
- Manual override for edge cases auto-detection misses

**Insight Generation:**
- Reconciliation dashboard shows progress (% matched)
- Unmatched items report highlights discrepancies
- Match audit trail enables compliance reporting

### Multi-Domain Applicability

This pattern applies universally to **multi-source data matching with confidence scoring**:

| Domain | Use Case | Source 1 | Source 2 | Cardinality Examples |
|--------|----------|----------|----------|----------------------|
| **Finance** | Bank reconciliation | Bank statements | Accounting ledger | 1:1 (payment), 1:N (split deposit), N:1 (batch payment) |
| **Healthcare** | Claim-payment matching | Provider claims | Insurance payments | 1:1 (single claim), 1:N (partial payments), N:1 (bundled claim) |
| **Legal** | Document linkage | Court filings | Case management | 1:1 (filing), 1:N (multi-doc case), N:1 (consolidated filing) |
| **Research** | Citation reconciliation | Paper citations | Publication database | 1:1 (exact match), 1:N (citing multiple), N:1 (duplicate citations) |
| **E-commerce** | Order-shipment tracking | Purchase orders | Shipment records | 1:1 (single item), 1:N (split shipment), N:1 (combined order) |

---

## User Journeys

### Journey 1: Accept Auto-Matched Items (High Confidence ≥95%)

**Context:** Maria runs monthly bank reconciliation. She uploads 100 bank transactions and 95 ledger entries. The system auto-detects 75 high-confidence matches (≥95%) overnight.

**User Goal:** Quickly review and accept high-confidence matches to focus on exceptions.

**Steps:**

1. **Maria opens Reconciliation Dashboard**
   - URL: `/reconciliation/bank-vs-ledger`
   - Dashboard loads showing reconciliation status

2. **Dashboard displays reconciliation progress**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Reconciliation Dashboard                                   │
   │ 150/195 items matched • 77% complete                       │
   ├────────────────────────────────────────────────────────────┤
   │ Progress: ████████████████████░░░░░░░ 77%                 │
   │ Matched: 75  Suggested: 15  Unmatched: 30                 │
   ├────────────────────────────────────────────────────────────┤
   │ ℹ️ 75 high-confidence matches (≥95%) ready to accept      │
   │                        [Accept All High-Confidence]        │
   ├────────────────────────────────────────────────────────────┤
   │ [Suggested Matches (15)] [Unmatched (30)] [Matched (75)]  │
   └────────────────────────────────────────────────────────────┘
   ```

3. **Maria reviews batch accept opportunity**:
   - Sees 75 matches with ≥95% confidence
   - Thinks: "75 matches look good, let me accept them all"
   - Hovers over "Accept All High-Confidence" button

4. **Maria clicks "Accept All High-Confidence Matches"**:
   - Button shows loading state: "Accepting 75 matches..."
   - Progress bar appears showing batch progress

5. **System processes batch acceptance** (takes ~5 seconds):
   ```
   For each high-confidence match:
     1. Create ReconciliationMatch record
     2. Mark items as matched
     3. Update dashboard counts
   ```

6. **Batch acceptance completes**:
   - Success toast: "✓ Accepted 75 matches"
   - Dashboard updates in real-time:
     ```
     Matched: 150 (was 75)
     Suggested: 15 (unchanged)
     Unmatched: 30 (was 105)
     Progress: 77% → 92%
     ```

7. **Maria reviews updated dashboard**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Reconciliation Dashboard                                   │
   │ 225/195 items matched • 92% complete                       │
   ├────────────────────────────────────────────────────────────┤
   │ Progress: ███████████████████████░ 92%                    │
   │ Matched: 150  Suggested: 15  Unmatched: 30                │
   ├────────────────────────────────────────────────────────────┤
   │ [Suggested Matches (15)] [Unmatched (30)] [Matched (150)] │
   └────────────────────────────────────────────────────────────┘
   ```

8. **Maria switches to "Suggested Matches" tab**:
   - Now focuses on 15 medium-confidence matches (70-94%)
   - Can review individually or batch reject low-quality suggestions

**Outcome:** Maria accepted 75 matches in ~20 seconds (vs ~1 hour manual review). Now focuses on 15 exceptions requiring judgment. Duration: ~1 minute total.

**Accessibility:**
- Screen reader: "75 high-confidence matches ready. Accept All button."
- Keyboard: Tab to button, Enter to accept, Escape to cancel
- Progress announced: "Accepting matches, 75% complete"

---

### Journey 2: Review Suggested Match (Medium Confidence 70-94%)

**Context:** Maria now reviews 15 medium-confidence matches. First match is 85% confident - amounts match exactly, but dates differ by 1 day and descriptions partially match.

**User Goal:** Review match details and decide whether to accept or reject.

**Steps:**

1. **Maria views first suggested match**:
   ```
   ┌──────────────────────────────────────────────────────────┐
   │ MEDIUM CONFIDENCE • 15 matches 70%-94%                   │
   │ ┌────────────────────────────────────────────────────────┐│
   │ │ 85% ████████████████▓░░░░░░             [Show Details ▾]││
   │ │                                                        ││
   │ │ Source 1                ↔              Source 2        ││
   │ │ Utility Payment            Electricity Bill Payment    ││
   │ │ $123.45 • Oct 14, 2024    $123.00 • Oct 15, 2024     ││
   │ │                                                        ││
   │ │                            [Reject]  [Accept Match]   ││
   │ └────────────────────────────────────────────────────────┘│
   └──────────────────────────────────────────────────────────┘
   ```

2. **Maria clicks "Show Details ▾"**:
   - Expands to show confidence breakdown

3. **Match details expand**:
   ```
   ┌──────────────────────────────────────────────────────────┐
   │ 85% ████████████████▓░░░░░░             [Hide Details ▴] │
   │                                                          │
   │ Source 1                ↔              Source 2          │
   │ Utility Payment            Electricity Bill Payment      │
   │ $123.45 • Oct 14, 2024    $123.00 • Oct 15, 2024       │
   │                                                          │
   │ ⚠️ Amount difference: $0.45                             │
   │ ⚠️ Date difference: 1 days                              │
   │                                                          │
   │ Confidence Breakdown:                                    │
   │ amount score      ████████████████░░░░  90%             │
   │ date score        ████████████████░░░░  80%             │
   │ description score ████████████████████  95%             │
   │ counterparty score ████████▓░░░░░░░░░░  65%             │
   │                                                          │
   │                            [Reject]  [Accept Match]     │
   └──────────────────────────────────────────────────────────┘
   ```

4. **Maria analyzes match quality**:
   - Amount: $0.45 difference (probably rounding) ✓
   - Date: 1 day difference (utility bills often show billing date vs payment date) ✓
   - Description: 95% match ("Utility Payment" vs "Electricity Bill Payment") ✓
   - Counterparty: 65% match (missing counterparty name on one side)
   - Overall: 85% confidence seems reasonable
   - Decision: Accept

5. **Maria clicks "Accept Match"**:
   - Match card shows loading state
   - System creates ReconciliationMatch record
   - Card animates out with slide-left transition
   - Success toast: "✓ Match accepted"

6. **Dashboard updates**:
   - Matched: 150 → 152 (+2 items)
   - Suggested: 15 → 14 (-1 match)
   - Progress: 92% → 93%

7. **Next suggested match auto-loads**:
   - Maria continues reviewing remaining 14 suggestions

**Outcome:** Maria reviewed match details, understood why 85% confidence was assigned, and accepted match confidently. Duration: ~30 seconds per match.

**Key Insight:** Feature-level breakdown (amount 90%, date 80%, description 95%, counterparty 65%) helps users understand match quality and make informed decisions.

---

### Journey 3: Create Manual Match (No Auto-Suggestion)

**Context:** After reviewing suggested matches, Maria finds 2 bank transactions with no suggestions. One is a $47.32 expense on Oct 10, the other is a $50.00 ledger entry on Oct 24. Auto-detection missed this because amounts differ by $2.68 and dates differ by 14 days.

**User Goal:** Manually link the expense to its reimbursement despite large differences.

**Steps:**

1. **Maria switches to "Unmatched" tab**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ [Suggested Matches (14)] [Unmatched (28)] [Matched (152)] │
   ├────────────────────────────────────────────────────────────┤
   │                                                            │
   │ Source 1 Unmatched (15)                                    │
   │ ┌──────────────────────────────────────────────────────┐  │
   │ │ □ Client Dinner Expense      $47.32 • Oct 10, 2024  │  │
   │ │ □ Parking Fee                $15.00 • Oct 12, 2024  │  │
   │ │ □ Office Supplies            $89.50 • Oct 18, 2024  │  │
   │ └──────────────────────────────────────────────────────┘  │
   │                                                            │
   │ Source 2 Unmatched (13)                                    │
   │ ┌──────────────────────────────────────────────────────┐  │
   │ │ □ Expense Reimbursement      $50.00 • Oct 24, 2024  │  │
   │ │ □ Parking Reimbursement      $15.00 • Oct 26, 2024  │  │
   │ │ □ Office Supply Order        $89.50 • Oct 20, 2024  │  │
   │ └──────────────────────────────────────────────────────┘  │
   │                                                            │
   │ [Manual Match Selected Items]                             │
   └────────────────────────────────────────────────────────────┘
   ```

2. **Maria recognizes match**:
   - $47.32 expense on Oct 10 is the client dinner
   - $50.00 reimbursement on Oct 24 is the reimbursement (employer rounds to $50)
   - Thinks: "These should be matched but system missed it"

3. **Maria clicks on "Client Dinner Expense"**:
   - Item card expands showing detail view
   - "Manual Match" button appears

4. **Maria clicks "Manual Match" button**:
   - ManualMatchDialog opens
   - Pre-selected item: Client Dinner Expense
   - Available targets: All Source 2 unmatched items

5. **ManualMatchDialog displays**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Create Manual Match                                    [×] │
   ├────────────────────────────────────────────────────────────┤
   │ Source Item (Source 1)                                     │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Client Dinner Expense                              │    │
   │ │ $47.32 • Oct 10, 2024                              │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ Match to (Source 2)                   Select one or more   │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Search items...                                    │    │
   │ └────────────────────────────────────────────────────┘    │
   │ ▸ Filters                                                  │
   │                                                            │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ □ Expense Reimbursement      $50.00 • Oct 24      │    │
   │ │ □ Parking Reimbursement      $15.00 • Oct 26      │    │
   │ │ □ Office Supply Order        $89.50 • Oct 20      │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ Notes *                                                    │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Explain why you're creating this manual match...  │    │
   │ └────────────────────────────────────────────────────┘    │
   │ Required: Explain why auto-detection missed this match    │
   │                                                            │
   │                              [Cancel]  [Create Match]     │
   │                                         (disabled)         │
   └────────────────────────────────────────────────────────────┘
   ```

6. **Maria searches for reimbursement**:
   - Types "reimbursement" in search box
   - Filter results update in real-time

7. **Search filters results**:
   ```
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ reimbursement                                      │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ □ Expense Reimbursement      $50.00 • Oct 24      │    │
   │ │ □ Parking Reimbursement      $15.00 • Oct 26      │    │
   │ └────────────────────────────────────────────────────┘    │
   ```

8. **Maria selects "Expense Reimbursement"**:
   - Clicks checkbox
   - Preview section appears showing match details

9. **Preview appears**:
   ```
   │ Match Preview                                              │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Cardinality:       one-to-one                      │    │
   │ │ Source Amount:     $47.32                          │    │
   │ │ Target Amount:     $50.00                          │    │
   │ │ Difference:        $2.68                           │    │ (in yellow)
   │ └────────────────────────────────────────────────────┘    │
   ```

10. **Validation warning appears**:
    ```
    │ ⚠️ Large amount difference: $47.32 vs $50.00 (5.7%)      │
    ```

11. **Maria adds notes** (required for manual matches):
    ```
    │ Notes *                                                    │
    │ ┌────────────────────────────────────────────────────┐    │
    │ │ Employer rounds reimbursements to nearest $5.      │    │
    │ │ Original receipt was $47.32 for client dinner.     │    │
    │ └────────────────────────────────────────────────────┘    │
    ```

12. **"Create Match" button becomes enabled**:
    - Notes field filled ✓
    - Target item selected ✓
    - Validation warnings acknowledged ✓

13. **Maria clicks "Create Match"**:
    - Button shows loading: "Creating Match..."
    - System creates ReconciliationMatch with:
      - cardinality: "one_to_one"
      - confidence: 0.75 (calculated from feature scores)
      - match_method: "manual"
      - notes: "Employer rounds reimbursements to nearest $5..."
      - matched_by: "user_maria"

14. **Match creation succeeds**:
    - Dialog closes with slide-down animation
    - Success toast: "✓ Manual match created"
    - Dashboard updates:
      - Matched: 152 → 154 (+2 items)
      - Unmatched: 28 → 26 (-2 items)
      - Progress: 93% → 95%

15. **Maria returns to Unmatched tab**:
    - Both items now gone from unmatched lists
    - Can view in "Matched" tab to verify

**Outcome:** Maria successfully linked items auto-detection missed due to amount/date differences. Notes provide audit trail explaining the variance. Duration: ~2 minutes.

**Key Learning:** Manual matching handles edge cases (amount rounding, date delays, description mismatches) that auto-detection can't confidently match.

---

### Journey 4: Reject False Positive (Medium Confidence)

**Context:** Maria reviews a 78% confidence suggestion. System suggests matching a $150 bank transaction to a $150 ledger entry, but Maria recognizes they're actually different transactions (same amount, same date, different purposes).

**User Goal:** Reject incorrect match suggestion to prevent false positive.

**Steps:**

1. **Maria reviews suggested match**:
   ```
   ┌──────────────────────────────────────────────────────────┐
   │ MEDIUM CONFIDENCE • 13 matches 70%-94%                   │
   │ ┌────────────────────────────────────────────────────────┐│
   │ │ 78% ██████████████░░░░░░               [Show Details ▾]││
   │ │                                                        ││
   │ │ Source 1                ↔              Source 2        ││
   │ │ Software License           Annual Software Subscription││
   │ │ $150.00 • Oct 15, 2024    $150.00 • Oct 15, 2024     ││
   │ │                                                        ││
   │ │                            [Reject]  [Accept Match]   ││
   │ └────────────────────────────────────────────────────────┘│
   └──────────────────────────────────────────────────────────┘
   ```

2. **Maria expands details**:
   ```
   │ Confidence Breakdown:                                    │
   │ amount score      ████████████████████  100%            │
   │ date score        ████████████████████  100%            │
   │ description score ████████░░░░░░░░░░░░  60%             │
   │ counterparty score ██████░░░░░░░░░░░░░  50%             │
   ```

3. **Maria analyzes**:
   - Amount: $150 exact match ✓
   - Date: Same date ✓
   - Description: "Software License" vs "Annual Software Subscription" (60% match) ⚠️
   - Counterparty: Different vendors (50% match) ⚠️
   - Maria's knowledge: These are TWO different software purchases on same day
   - Decision: Reject

4. **Maria clicks "Reject"**:
   - Dialog appears: "Why are you rejecting this match?"
   - Required reason field appears

5. **Rejection dialog displays**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Reject Match Suggestion                                [×] │
   ├────────────────────────────────────────────────────────────┤
   │                                                            │
   │ Why are you rejecting this match? *                        │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Different transactions - "Software License" is     │    │
   │ │ for Adobe, "Annual Software Subscription" is for   │    │
   │ │ Microsoft 365. Both happened same day.             │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │                              [Cancel]  [Reject Match]     │
   └────────────────────────────────────────────────────────────┘
   ```

6. **Maria clicks "Reject Match"**:
   - System records rejection with reason
   - Match card animates out
   - Success toast: "✓ Match rejected"

7. **Dashboard updates**:
   - Suggested: 13 → 12 (-1 match)
   - Unmatched: 26 → 26 (unchanged - items return to unmatched)
   - Both items stay in unmatched lists for separate handling

8. **Rejection stored for future learning**:
   - System can use rejection feedback to improve future matching
   - Rejection reason helps identify false positive patterns

**Outcome:** Maria prevented false positive match. Rejection reason provides feedback for improving auto-detection. Duration: ~1 minute.

**Key Insight:** Medium-confidence matches (70-94%) require human judgment - system correctly identified this as uncertain and asked for review.

---

### Journey 5: Handle Split Transaction (One-to-Many)

**Context:** Maria finds a single $5,000 bank deposit with no match. Checking ledger, she sees two entries: $3,000 and $2,000 on same date. This is a split deposit for two different clients.

**User Goal:** Create one-to-many match linking single bank deposit to two ledger entries.

**Steps:**

1. **Maria identifies split transaction**:
   - Bank (Source 1): Single $5,000 deposit on Oct 20
   - Ledger (Source 2): $3,000 entry + $2,000 entry on Oct 20
   - Total: $3,000 + $2,000 = $5,000 ✓

2. **Maria opens Manual Match Dialog**:
   - Pre-selected: $5,000 bank deposit
   - Available targets: All unmatched ledger entries

3. **Dialog displays with multi-select enabled**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Create Manual Match                                    [×] │
   ├────────────────────────────────────────────────────────────┤
   │ Source Item (Source 1)                                     │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Bulk Deposit                                       │    │
   │ │ $5,000.00 • Oct 20, 2024                           │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ Match to (Source 2)                   Select one or more   │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Search items...                                    │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ □ Payment Received - Client A  $3,000.00 • Oct 20 │    │
   │ │ □ Payment Received - Client B  $2,000.00 • Oct 20 │    │
   │ │ □ Refund Processed             $150.00 • Oct 21   │    │
   │ └────────────────────────────────────────────────────┘    │
   └────────────────────────────────────────────────────────────┘
   ```

4. **Maria selects BOTH ledger entries**:
   - Clicks checkbox for "Payment Received - Client A" ($3,000)
   - Clicks checkbox for "Payment Received - Client B" ($2,000)
   - Selection count updates: "2 selected (max 10)"

5. **Preview appears showing one-to-many match**:
   ```
   │ Match Preview                                              │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Cardinality:       one-to-many                     │    │
   │ │ Source Amount:     $5,000.00                       │    │
   │ │ Target Amount:     $5,000.00                       │    │
   │ │ Difference:        $0.00                           │    │ (in green)
   │ └────────────────────────────────────────────────────┘    │
   ```

6. **Amounts match perfectly**:
   - $5,000 (source) = $3,000 + $2,000 (targets) ✓
   - No validation warnings
   - "Create Match" button enabled

7. **Maria adds notes**:
   ```
   │ Notes *                                                    │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Single bank deposit split into two ledger entries │    │
   │ │ for different clients (A: $3k, B: $2k)             │    │
   │ └────────────────────────────────────────────────────┘    │
   ```

8. **Maria clicks "Create Match"**:
   - System creates one-to-many match:
     - source_1_items: ["bank_deposit_001"]
     - source_2_items: ["ledger_client_a_001", "ledger_client_b_002"]
     - cardinality: "one_to_many"
     - match_method: "manual"

9. **Match creation succeeds**:
   - Success toast: "✓ One-to-many match created"
   - Dashboard updates:
     - Matched: 154 → 160 (+6: 1 bank + 2 ledger × 2 sides)
     - Unmatched: 26 → 23 (-3 items)
     - Progress: 95% → 97%

10. **Maria views in Matched tab**:
    ```
    ┌──────────────────────────────────────────────────────────┐
    │ ✓ Bulk Deposit ↔ Payment Received - Client A + Client B │
    │ $5,000.00 • Oct 20, 2024                                 │
    │ Cardinality: one-to-many • Method: Manual                │
    │ Note: Single bank deposit split into two ledger entries  │
    │                                                 [Unmatch]│
    └──────────────────────────────────────────────────────────┘
    ```

**Outcome:** Maria successfully linked one bank deposit to two ledger entries, preserving the split payment relationship. Duration: ~3 minutes.

**Key Feature:** Multi-select support in ManualMatchDialog enables one-to-many and many-to-one cardinalities for split/batch transactions.

---

### Journey 6: Adjust Thresholds and Re-Run Reconciliation

**Context:** After initial reconciliation, Maria has 10 medium-confidence suggestions (70-80%) that she thinks should be auto-accepted. She wants to lower the auto-link threshold from 95% to 90% and re-run.

**User Goal:** Adjust configuration to auto-accept more matches, then re-run reconciliation to apply new thresholds.

**Steps:**

1. **Maria clicks "⚙️ Configure" button**:
   - Configuration dialog opens
   - Shows current thresholds

2. **Configuration dialog displays**:
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Reconciliation Configuration                           [×] │
   ├────────────────────────────────────────────────────────────┤
   │                                                            │
   │ Confidence Thresholds                                      │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Auto-link threshold (auto-accept):                 │    │
   │ │ [95]% ───────●──────────────── 100%                │    │
   │ │ Matches ≥95% will be auto-accepted                 │    │
   │ │                                                    │    │
   │ │ Auto-suggest threshold (show for review):          │    │
   │ │ [70]% ───────●──────────────── 100%                │    │
   │ │ Matches 70%-94% will be suggested                  │    │
   │ │                                                    │    │
   │ │ Manual threshold (allow manual):                   │    │
   │ │ [50]% ───────●──────────────── 100%                │    │
   │ │ Matches 50%-69% can be manually created            │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ Tolerances                                                 │
   │ ┌────────────────────────────────────────────────────┐    │
   │ │ Amount tolerance: ±[5]%                            │    │
   │ │ Date tolerance: ±[3] days                          │    │
   │ └────────────────────────────────────────────────────┘    │
   │                                                            │
   │ Preview Impact:                                            │
   │ • 10 additional matches will be auto-linked (90-94%)      │
   │ • 5 matches will move from suggest to manual (65-69%)     │
   │                                                            │
   │                              [Cancel]  [Save & Re-run]    │
   └────────────────────────────────────────────────────────────┘
   ```

3. **Maria adjusts auto-link threshold**:
   - Drags slider from 95% to 90%
   - Preview updates in real-time:
     ```
     Preview Impact:
     • 10 additional matches will be auto-linked (90-94%)
     • 0 matches will move to suggest
     ```

4. **Maria reviews impact**:
   - 10 matches (85-94% confidence) will auto-accept
   - Thinks: "Yes, I want to accept 85%+ automatically"
   - Decision: Proceed

5. **Maria clicks "Save & Re-run"**:
   - Config saved to ReconciliationConfig
   - Re-run reconciliation triggered
   - Loading overlay appears: "Running reconciliation..."

6. **System re-runs reconciliation** (takes ~10 seconds):
   ```
   1. Load updated config (auto_link: 0.90, auto_suggest: 0.70, manual: 0.50)
   2. Regenerate match candidates with new thresholds
   3. Re-score all candidates
   4. Apply new decisions (auto_link vs suggest vs manual)
   5. Update dashboard counts
   ```

7. **Re-run completes**:
   - Loading overlay dismisses
   - Success toast: "✓ Reconciliation complete - 10 new matches auto-linked"
   - Dashboard updates:
     ```
     Before:
     Matched: 160, Suggested: 10, Unmatched: 23

     After:
     Matched: 180 (+20: 10 matches × 2 items each)
     Suggested: 0 (-10)
     Unmatched: 13 (-10)
     Progress: 97% → 99%
     ```

8. **Maria reviews results**:
   - All medium-confidence matches now auto-accepted
   - Only 13 unmatched items remain (low confidence or no candidates)
   - Reconciliation effectively complete

**Outcome:** Maria adjusted thresholds to match her risk tolerance and re-ran reconciliation, auto-accepting 10 additional matches. Duration: ~2 minutes.

**Key Feature:** Threshold adjustment with real-time preview shows impact before committing. Re-run applies new config to existing candidates.

---

## Visual Wireframes

### Wireframe 1: Dashboard Overview (Initial Load)

```
┌──────────────────────────────────────────────────────────────────────┐
│ Reconciliation Dashboard: Bank vs Ledger                            │
│ 0/195 items matched • 0% complete                                   │
│                               [⚙️ Configure] [🔄 Re-run] [📊 Export] │
├──────────────────────────────────────────────────────────────────────┤
│ Progress: ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 0%                        │
│ Matched: 0  Suggested: 0  Unmatched: 195                            │
├──────────────────────────────────────────────────────────────────────┤
│ [Suggested Matches (0)] [Unmatched (195)] [Matched (0)]             │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│ Source 1 Unmatched (100)                                             │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ □ Payment to Vendor A            $1,234.56 • Oct 15, 2024     │  │
│ │ □ Utility Payment                $123.45 • Oct 14, 2024       │  │
│ │ □ Client Dinner Expense          $47.32 • Oct 10, 2024        │  │
│ │ ... (97 more)                                                 │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ Source 2 Unmatched (95)                                              │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ □ Accounts Payable - Vendor A    $1,234.56 • Oct 15, 2024     │  │
│ │ □ Electricity Bill Payment       $123.00 • Oct 15, 2024       │  │
│ │ □ Expense Reimbursement          $50.00 • Oct 24, 2024        │  │
│ │ ... (92 more)                                                 │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ [Run Initial Reconciliation]                                        │
└──────────────────────────────────────────────────────────────────────┘
```

### Wireframe 2: After Auto-Reconciliation (High Confidence Batch)

```
┌──────────────────────────────────────────────────────────────────────┐
│ Reconciliation Dashboard: Bank vs Ledger                            │
│ 150/195 items matched • 77% complete                                │
│                               [⚙️ Configure] [🔄 Re-run] [📊 Export] │
├──────────────────────────────────────────────────────────────────────┤
│ Progress: ████████████████████░░░░░░░ 77%                          │
│ Matched: 75  Suggested: 15  Unmatched: 30                           │
├──────────────────────────────────────────────────────────────────────┤
│ ℹ️ 75 high-confidence matches (≥95%) ready to accept                │
│                                   [Accept All High-Confidence]       │
├──────────────────────────────────────────────────────────────────────┤
│ [Suggested Matches (15)] [Unmatched (30)] [Matched (75)]            │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│ HIGH CONFIDENCE • 75 matches ≥ 95%                                  │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ 98% ████████████████████▓                   [Show Details ▾]  │  │
│ │                                                                │  │
│ │ Source 1                   ↔                   Source 2        │  │
│ │ Payment to Vendor A            Accounts Payable - Vendor A    │  │
│ │ $1,234.56 • Oct 15, 2024      $1,234.56 • Oct 15, 2024       │  │
│ │                                                                │  │
│ │                                   [Reject]  [Accept Match]    │  │
│ └────────────────────────────────────────────────────────────────┘  │
│ ... (74 more high-confidence matches)                               │
└──────────────────────────────────────────────────────────────────────┘
```

### Wireframe 3: Match Review Dialog (Medium Confidence)

```
┌────────────────────────────────────────────────────────────┐
│ Review Match Suggestion                                [×] │
│ [85% Confidence] MEDIUM                                    │
├────────────────────────────────────────────────────────────┤
│                                                            │
│ Item Comparison                                            │
│ ┌────────────────┐         ┌────────────────┐            │
│ │ Source 1       │    ↔    │ Source 2       │            │
│ │                │   85%   │                │            │
│ │ Utility        │         │ Electricity    │            │
│ │ Payment        │         │ Bill Payment   │            │
│ │                │         │                │            │
│ │ $123.45        │         │ $123.00        │            │
│ │ Oct 14, 2024   │         │ Oct 15, 2024   │            │
│ └────────────────┘         └────────────────┘            │
│                                                            │
│ ⚠️ Amount difference: $0.45                               │
│ ⚠️ Date difference: 1 days                                │
│                                                            │
│ Confidence Breakdown                        [Hide ▴]      │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Amount Score      ████████████████░░░░   90%       │    │
│ │ Date Score        ████████████████░░░░   80%       │    │
│ │ Description Score ████████████████████   95%       │    │
│ │ Counterparty Score ████████▓░░░░░░░░░░   65%       │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Technical Details                           [Show ▾]      │
│                                                            │
│ Notes (optional)                                           │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Utility provider bills one day in advance         │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│              [Cancel]  [Reject Match]  [Accept Match]     │
└────────────────────────────────────────────────────────────┘
```

### Wireframe 4: Manual Match Dialog (One-to-Many)

```
┌────────────────────────────────────────────────────────────┐
│ Create Manual Match                                    [×] │
├────────────────────────────────────────────────────────────┤
│ Source Item (Source 1)                                     │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Bulk Deposit                                       │    │
│ │ $5,000.00 • Oct 20, 2024                           │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Match to (Source 2)                   2 selected (max 10)  │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Search items...                                    │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ ┌────────────────────────────────────────────────────┐    │
│ │ ✓ Payment Received - Client A   $3,000.00 • Oct 20│    │
│ │ ✓ Payment Received - Client B   $2,000.00 • Oct 20│    │
│ │ □ Refund Processed              $150.00 • Oct 21   │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Match Preview                                              │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Cardinality:       one-to-many                     │    │
│ │ Source Amount:     $5,000.00                       │    │
│ │ Target Amount:     $5,000.00                       │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Notes *                                                    │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Single bank deposit split into two ledger entries │    │
│ │ for different clients                              │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│                              [Cancel]  [Create Match]     │
└────────────────────────────────────────────────────────────┘
```

### Wireframe 5: Configuration Dialog

```
┌────────────────────────────────────────────────────────────┐
│ Reconciliation Configuration                           [×] │
├────────────────────────────────────────────────────────────┤
│                                                            │
│ Confidence Thresholds                                      │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Auto-link threshold (auto-accept):                 │    │
│ │ [95]% ───────●──────────────── 100%                │    │
│ │ Matches ≥95% will be auto-accepted                 │    │
│ │                                                    │    │
│ │ Auto-suggest threshold (show for review):          │    │
│ │ [70]% ───────●──────────────── 100%                │    │
│ │ Matches 70%-94% will be suggested                  │    │
│ │                                                    │    │
│ │ Manual threshold (allow manual):                   │    │
│ │ [50]% ───────●──────────────── 100%                │    │
│ │ Matches 50%-69% can be manually created            │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Tolerances                                                 │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Amount tolerance: ±[5]%                            │    │
│ │ Date tolerance: ±[3] days                          │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Feature Weights (must sum to 100%)                         │
│ ┌────────────────────────────────────────────────────┐    │
│ │ Amount:        [50]%                               │    │
│ │ Date:          [30]%                               │    │
│ │ Counterparty:  [15]%                               │    │
│ │ Description:   [5]%                                │    │
│ │ Total:         100% ✓                              │    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Blocking (Performance)                                     │
│ ┌────────────────────────────────────────────────────┐    │
│ │ ☑ Enable blocking                                  │    │
│ │ Fields: [✓] Date  [✓] Amount Bucket  [ ] First Char│    │
│ └────────────────────────────────────────────────────┘    │
│                                                            │
│ Preview Impact:                                            │
│ • Current settings: 75 auto-linked, 15 suggested          │
│ • No changes detected                                      │
│                                                            │
│                              [Cancel]  [Save & Re-run]    │
└────────────────────────────────────────────────────────────┘
```

### Wireframe 6: Matched Items Tab

```
┌──────────────────────────────────────────────────────────────────────┐
│ [Suggested Matches (0)] [Unmatched (13)] [Matched (180)]            │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ ✓ Payment to Vendor A ↔ Accounts Payable - Vendor A           │  │
│ │ $1,234.56 • Oct 15, 2024                                       │  │
│ │ Confidence: 98% • Method: Auto • Matched: Oct 25, 2024 2:30 PM│  │
│ │                                                     [Unmatch]  │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ ✓ Bulk Deposit ↔ Payment Client A + Payment Client B          │  │
│ │ $5,000.00 • Oct 20, 2024                                       │  │
│ │ Cardinality: one-to-many • Method: Manual                      │  │
│ │ Note: Single bank deposit split into two ledger entries        │  │
│ │ Matched by: Maria • Matched: Oct 25, 2024 3:15 PM             │  │
│ │                                                     [Unmatch]  │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ ... (178 more matched items)                                        │
└──────────────────────────────────────────────────────────────────────┘
```

### Wireframe 7: Unmatched Items with Action Buttons

```
┌──────────────────────────────────────────────────────────────────────┐
│ [Suggested Matches (0)] [Unmatched (13)] [Matched (180)]            │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│ Source 1 Unmatched (8)                                               │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ Parking Fee                          $15.00 • Oct 12, 2024     │  │
│ │ [Manual Match] [Mark as Exception]                             │  │
│ ├────────────────────────────────────────────────────────────────┤  │
│ │ Office Supplies                      $89.50 • Oct 18, 2024     │  │
│ │ [Manual Match] [Mark as Exception]                             │  │
│ ├────────────────────────────────────────────────────────────────┤  │
│ │ Software License                     $150.00 • Oct 15, 2024    │  │
│ │ [Manual Match] [Mark as Exception]                             │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ Source 2 Unmatched (5)                                               │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │ Parking Reimbursement                $15.00 • Oct 26, 2024     │  │
│ │ [Manual Match] [Mark as Exception]                             │  │
│ ├────────────────────────────────────────────────────────────────┤  │
│ │ Office Supply Order                  $89.50 • Oct 20, 2024     │  │
│ │ [Manual Match] [Mark as Exception]                             │  │
│ └────────────────────────────────────────────────────────────────┘  │
│                                                                      │
│ [Export Unmatched Items Report]                                     │
└──────────────────────────────────────────────────────────────────────┘
```

### Wireframe 8: Reconciliation Complete

```
┌──────────────────────────────────────────────────────────────────────┐
│ Reconciliation Dashboard: Bank vs Ledger                            │
│ 182/195 items matched • 93% complete                                │
│                               [⚙️ Configure] [🔄 Re-run] [📊 Export] │
├──────────────────────────────────────────────────────────────────────┤
│ Progress: ███████████████████████░ 93%                             │
│ Matched: 91  Suggested: 0  Unmatched: 13                            │
├──────────────────────────────────────────────────────────────────────┤
│ ✓ Reconciliation Complete!                                          │
│                                                                      │
│ Summary:                                                             │
│ • 75 auto-matched (high confidence ≥95%)                            │
│ • 12 manually reviewed and accepted (medium confidence 70-94%)      │
│ • 4 manually created (no auto-suggestion)                           │
│ • 3 rejected (false positives)                                      │
│ • 13 unmatched items remaining (review recommended)                 │
│                                                                      │
│ [View Unmatched Items] [Export Reconciliation Report]              │
└──────────────────────────────────────────────────────────────────────┘
```

---

## Accessibility

**Keyboard Support:**
- **Tab**: Navigate between dashboard sections, match cards, buttons
- **Enter**: Accept match, create manual match, confirm dialogs
- **Escape**: Close dialogs, cancel operations
- **Arrow keys**: Navigate within match lists
- **Space**: Toggle checkboxes in manual match dialog

**Screen Reader Announcements:**
- Dashboard: "Reconciliation dashboard. 150 of 195 items matched, 77% complete."
- High confidence batch: "75 high-confidence matches ready to accept. Accept All button."
- Match card: "Match suggestion. 85% confidence. Source 1: Utility Payment, $123.45, October 14. Source 2: Electricity Bill Payment, $123.00, October 15."
- Confidence breakdown: "Amount score 90%, Date score 80%, Description score 95%, Counterparty score 65%."
- Accept/Reject: "Match accepted" / "Match rejected"
- Manual match: "Manual match dialog. Source item: Bulk Deposit, $5,000. Select target items."

**ARIA Labels:**
- `role="region" aria-label="Reconciliation Dashboard"`
- `role="tablist"` for tab navigation
- `role="list"` for match lists
- `role="listitem"` for individual matches
- `aria-live="polite"` for status updates
- `aria-busy="true"` during reconciliation runs

---

## Multi-Domain Examples Throughout Journeys

All journeys above use **Finance domain** (bank reconciliation). Here are parallel examples for other domains:

**Healthcare - Claim-Payment Matching:**
- High confidence: Provider claim $350 matched to insurance payment $280 (80% coverage)
- Medium confidence: Claim date vs payment date differ by 5 days
- Manual match: Bundled claim (N:1) - multiple procedure claims matched to single payment

**Legal - Document Linkage:**
- High confidence: Original filing matched to case record (same case number)
- Medium confidence: Amendment filing vs original (description similarity 75%)
- Manual match: Multi-document case (1:N) - one case matched to multiple filings

**E-commerce - Order-Shipment:**
- High confidence: Order $299.99 matched to shipment $299.99 (same tracking)
- Medium confidence: Order date vs ship date differ by 2 days
- Manual match: Split shipment (1:N) - one order matched to two shipment records

---

## Summary

The Reconciliation Strategies experience provides:

✅ **Auto-matching** identifies 80-95% of matches (high confidence ≥95%)
✅ **Batch operations** accept all high-confidence matches with one click
✅ **Confidence tiers** (high/medium/low) prioritize user attention
✅ **Feature-level breakdown** shows why matches were suggested
✅ **Manual matching** handles edge cases with one-to-many/many-to-one support
✅ **Threshold adjustment** with real-time preview and re-run
✅ **Audit trail** for all matches (who, when, why, confidence)
✅ **Unmatched items** clearly flagged for investigation
✅ **Multi-domain support** (finance, healthcare, legal, research, e-commerce)

Users spend 90% less time on reconciliation, with higher accuracy and complete audit trail for compliance.

---

**Status:** ✅ Complete
**Estimated Implementation Time:** 6-8 weeks (full reconciliation system)
**Dependencies:** ReconciliationEngine, ReconciliationStore, MatchScorer, ThresholdManager, ReconciliationDashboard, MatchReviewDialog, ManualMatchDialog
