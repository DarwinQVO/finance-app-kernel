# UX Flow: Security & Access Experience (Vertical 5.4)

**Version:** 1.0.0
**Last Updated:** 2025-10-25
**Status:** Complete

---

## Table of Contents

1. [Overview](#overview)
2. [User Personas](#user-personas)
3. [User Journeys](#user-journeys)
4. [Wireframes](#wireframes)
5. [Interaction Patterns](#interaction-patterns)
6. [Accessibility](#accessibility)
7. [Performance](#performance)
8. [Edge Cases](#edge-cases)
9. [Multi-Domain Examples](#multi-domain-examples)

---

## Overview

This document defines the complete user experience for **Vertical 5.4: Security & Access**, covering PII masking, role-based access control, encryption, and audit logging workflows.

### Key User Flows

1. **Security Monitoring** - Real-time dashboard showing access denials, PII activity, security events
2. **Role Management** - Assign/revoke user roles, preview permissions, set expiration
3. **Audit Review** - Filter audit logs, investigate security events, export compliance reports
4. **PII Unmask Requests** - Owner unmasks sensitive data with documented reason
5. **Access Denied Handling** - Clear error messages, request access flow
6. **Security Alerts** - Automated alerts for suspicious activity, PII unmask events

### Design Principles

- **Trust but Verify** - Easy access for authorized users, strict controls for sensitive data
- **Audit Everything** - Every action logged immutably for compliance
- **Progressive Disclosure** - Show summary first, details on demand
- **Fail Secure** - Errors default to deny access, not grant
- **Clear Communication** - Explain why access denied, how to request permission

---

## User Personas

### 1. Security Administrator (Sarah)
- **Role:** Owner
- **Goals:** Monitor security, respond to alerts, manage user roles
- **Pain Points:** Too many false positives, alert fatigue
- **Technical Skill:** High

### 2. Compliance Auditor (Carlos)
- **Role:** Auditor
- **Goals:** Review audit logs, generate compliance reports, verify controls
- **Pain Points:** Difficult to filter logs, slow exports
- **Technical Skill:** Medium

### 3. Finance Manager (Fiona)
- **Role:** Accountant (Read-Only)
- **Goals:** View financial data, generate reports, no PII access needed
- **Pain Points:** Sees too much sensitive data, risk of accidental exposure
- **Technical Skill:** Low

### 4. Operations Engineer (Oscar)
- **Role:** Editor
- **Goals:** Upload documents, run parsers, troubleshoot errors
- **Pain Points:** Unclear permission boundaries, can't debug PII-related issues
- **Technical Skill:** High

### 5. Business Owner (Olivia)
- **Role:** Owner
- **Goals:** Access any data when needed, manage team permissions
- **Pain Points:** Too many approval steps, can't move fast
- **Technical Skill:** Low

---

## User Journeys

### Journey 1: Security Admin Reviews Dashboard

**Persona:** Sarah (Security Administrator)
**Goal:** Check daily security posture, respond to alerts

**Steps:**

1. **Login** (9:00 AM)
   - Sarah opens app, sees SecurityDashboard
   - 4 panels visible: Access Denials (24h chart), PII Activity (table), Security Events (timeline), User Activity (heatmap)

2. **Review Access Denials Panel**
   - Chart shows 12 denied requests in last hour (spike!)
   - Hovers over spike â†’ Tooltip: "11:45 AM - 12 denials by usr_contractor"
   - **Insight:** Contractor trying to access data outside their permissions

3. **Investigate Denials**
   - Clicks spike â†’ Drill-down to AuditViewer
   - Filters: `user_id=usr_contractor`, `result=denied`, `time=11:45-12:00`
   - Sees 12 events: All attempts to delete observations (contractor only has read permission)

4. **Check PII Activity Table**
   - Returns to dashboard
   - PII Activity shows 2 unmask requests today:
     - usr_owner unmasked obs_123 (reason: "Fraud investigation case #567")
     - usr_admin unmasked obs_456 (reason: "Customer support ticket #789")
   - Both legitimate, no action needed

5. **Review Security Events Timeline**
   - Timeline shows recent events chronologically
   - 3 failed login attempts from IP 203.0.113.42 (suspicious!)
   - Clicks event â†’ Opens incident details
   - IP geolocated to foreign country (not normal for this user)

6. **Take Action**
   - Clicks "Create Incident" button
   - Incident created, assigned to security team
   - User account usr_contractor temporarily locked
   - Notification sent to contractor: "Account locked due to suspicious activity, contact security to unlock"

**Outcome:** Security issue identified and mitigated within 15 minutes

---

### Journey 2: Owner Unmasks PII (with Audit Trail)

**Persona:** Olivia (Business Owner)
**Goal:** View full account number to verify payment issue

**Steps:**

1. **View Observation (Masked)**
   - Olivia searches for transaction: "ACME Corp payment Sept 2025"
   - Opens observation obs_789
   - Sees: `account_number: ****1234` (last 4 digits only)
   - Sees: `ssn: ***-**-6789` (last 4 digits only)

2. **Request Unmask**
   - Clicks "Show Full Account Number" button
   - Dialog appears: "Why do you need to see unmasked data?"
   - Required field: Reason (text area, 50-500 chars)

3. **Provide Reason**
   - Olivia types: "Customer reported payment failure, need to verify account number matches bank records for support ticket #12345"
   - Clicks "Confirm"

4. **Verify Identity (MFA)**
   - System requires MFA re-authentication (because unmask is high-risk)
   - Olivia enters 2FA code from authenticator app
   - Confirmed

5. **View Unmasked Data**
   - account_number now shows: `1234567812345678` (full number)
   - Banner at top: "âš ï¸ Unmasked PII visible - This action has been logged for audit"
   - Timer: "Will re-mask in 5 minutes"

6. **Audit Log Created**
   - Background: AuditLogger.logEvent()
   - event_type: "security_event"
   - action: "unmask_pii"
   - user_id: "usr_olivia"
   - resource_id: "obs_789"
   - metadata.reason: "Customer reported payment failure..."
   - metadata.alert_triggered: true

7. **Security Alert Sent**
   - PagerDuty alert sent to security team (informational, not urgent)
   - Slack message: "ğŸ” PII Unmask: usr_olivia viewed full account_number for obs_789 (Reason: Customer support ticket #12345)"

8. **Auto Re-Mask**
   - After 5 minutes, account_number automatically re-masked
   - User must request unmask again if needed

**Outcome:** Owner accessed sensitive data with full audit trail, security team notified

---

### Journey 3: Admin Assigns Role (Temporary Contractor Access)

**Persona:** Sarah (Security Administrator)
**Goal:** Grant contractor temporary access to specific project uploads

**Steps:**

1. **Open Role Manager**
   - Sarah navigates to Settings â†’ Role Manager
   - Sees list of users (25 users in tenant)

2. **Add New User**
   - Clicks "Add User" button
   - Dialog: Email field
   - Enters: "contractor@external.com"
   - System creates user: usr_contractor_ext

3. **Assign Role**
   - User row appears in table
   - Current role: None (no access)
   - Sarah clicks "Assign Role" dropdown
   - Options: Owner, Editor, Viewer, Accountant (Read-Only), Auditor

4. **Preview Permissions**
   - Hovers over "Editor" option
   - Tooltip shows permission preview:
     - âœ… Upload documents
     - âœ… Run parsers
     - âœ… Read/write observations
     - âŒ Delete observations
     - âŒ Manage users
     - âŒ Export data

5. **Limit Scope**
   - Sarah wants contractor to only access "Project Alpha" uploads
   - Clicks "Advanced" â†’ Shows resource scope selector
   - Selects: `resource_type=upload`, `resource_id=upl_project_alpha`

6. **Set Expiration**
   - Sarah clicks "Expiration Date" field
   - Date picker appears
   - Selects: 2025-12-31 (3 months from now, when contract ends)

7. **Confirm Assignment**
   - Review summary:
     - User: contractor@external.com
     - Role: Editor (limited to Project Alpha uploads)
     - Expires: 2025-12-31
   - Sarah clicks "Confirm"

8. **User Notified**
   - Email sent to contractor@external.com:
     - Subject: "Access Granted: ACME Corp Data Platform"
     - Body: "You have been granted Editor access to Project Alpha uploads until 2025-12-31. Click here to log in."
   - Link includes invitation token (valid 7 days)

9. **Audit Log Created**
   - event_type: "user_action"
   - action: "role_assign"
   - user_id: "usr_sarah" (granter)
   - resource_id: "usr_contractor_ext" (grantee)
   - metadata.role: "editor"
   - metadata.scope: "upload/upl_project_alpha"
   - metadata.expiration: "2025-12-31"

**Outcome:** Contractor has time-limited, scoped access with full audit trail

---

### Journey 4: Auditor Reviews Audit Logs (Compliance Report)

**Persona:** Carlos (Compliance Auditor)
**Goal:** Generate quarterly compliance report showing all PII unmask events

**Steps:**

1. **Open Audit Viewer**
   - Carlos navigates to Audit Logs
   - Sees paginated table: 10,000+ events (last 90 days)

2. **Apply Filters**
   - Time Range: Q3 2025 (July 1 - Sept 30)
   - Event Type: "security_event"
   - Action: "unmask_pii"
   - Result: "success"

3. **Review Results**
   - Table updates: 47 unmask events found
   - Columns: Timestamp, User, Resource, Reason, IP Address
   - Sorts by timestamp (newest first)

4. **Investigate Anomaly**
   - Carlos notices: usr_temp_contractor unmasked 12 observations in 1 day (unusual!)
   - Clicks row â†’ Expands detail panel
   - Shows: All 12 unmasks had same reason: "Data migration"
   - **Red Flag:** Contractor shouldn't be unmasking PII for migration

5. **Check User Permissions**
   - Clicks usr_temp_contractor link â†’ Opens user detail
   - Role: Editor (should NOT have unmask permission!)
   - **Issue:** Role misconfigured, bug in permission check

6. **Flag for Investigation**
   - Carlos clicks "Flag Event" button
   - Creates incident: "Contractor with Editor role able to unmask PII (permission bypass)"
   - Assigns to security team
   - Priority: High

7. **Export Report**
   - Returns to filtered audit log
   - Clicks "Export" button â†’ Dropdown: CSV, PDF, JSON
   - Selects PDF
   - Template: "Compliance Report - PII Access"

8. **Download Report**
   - PDF generates in 3 seconds (47 events)
   - Opens PDF: Professional format with:
     - Company logo, report title
     - Date range, filter criteria
     - Summary: 47 total events, 46 by owners, 1 by contractor (flagged)
     - Detailed table: All 47 events with reasons
     - Footer: "Generated on 2025-10-15 by usr_carlos_auditor"

9. **Save for Compliance Review**
   - Carlos saves PDF to shared drive
   - Adds to quarterly compliance package
   - Notes: "1 issue flagged for investigation (contractor permission bypass)"

**Outcome:** Compliance report generated, security issue discovered and flagged

---

### Journey 5: Accountant Views Financial Data (PII Masked)

**Persona:** Fiona (Finance Manager)
**Goal:** Review monthly expenses, no PII exposure needed

**Steps:**

1. **Login** (Role: Accountant Read-Only)
   - Fiona logs in, sees dashboard
   - Banner: "ğŸ”’ Read-Only Mode: PII fields are masked"

2. **Query Observations**
   - Searches: "All transactions, October 2025"
   - Results: 1,247 observations

3. **View Observation (Masked)**
   - Opens obs_456
   - Sees:
     - merchant: "Starbucks" (visible)
     - amount: $5.47 (visible)
     - date: 2025-10-15 (visible)
     - account_number: ****1234 (MASKED)
     - ssn: ***-**-6789 (MASKED)
   - Info tooltip: "â„¹ï¸ PII fields masked per your role (Accountant Read-Only)"

4. **Attempt Unmask (Denied)**
   - Fiona clicks "Show Full Account Number" button (curiosity)
   - Dialog: "â›” Access Denied"
   - Message: "Your role (Accountant Read-Only) does not have permission to unmask PII. Contact your administrator if you need access."
   - Button: "Request Access" (sends email to admin)

5. **Export Data (Allowed)**
   - Fiona generates monthly expense report
   - Clicks "Export to CSV"
   - CSV downloads: PII fields remain masked in export
   - account_number column: ****1234 (masked in CSV too!)

6. **Audit Log Created**
   - event_type: "data_access"
   - user_id: "usr_fiona"
   - action: "export"
   - resource_id: "1247 observations"
   - metadata.masked_fields: ["account_number", "ssn"]
   - result: "success"

**Outcome:** Accountant completed work with zero PII exposure, audit trail clean

---

### Journey 6: Security Event Triggered (Failed Access â†’ Alert â†’ Investigation)

**Persona:** System (Automated) + Sarah (Security Admin)
**Goal:** Detect suspicious activity, alert team, investigate

**Steps:**

1. **Failed Access Attempt** (11:45 AM)
   - User: usr_contractor_ext
   - Action: DELETE /observations/obs_123
   - Result: 403 Forbidden (role: editor, required: owner)

2. **Audit Log Created**
   - event_type: "security_event"
   - action: "delete"
   - result: "denied"
   - error_message: "User 'usr_contractor_ext' does not have permission to delete observation 'obs_123'"

3. **Rate Limit Check**
   - System detects: 5 failed access attempts in 1 minute (same user)
   - Threshold exceeded: >3 failures/minute = suspicious

4. **Security Alert Triggered**
   - Alert rule: "High failed access rate"
   - Severity: Warning
   - PagerDuty alert sent to security team
   - Slack message: "âš ï¸ Security Alert: usr_contractor_ext had 5 failed access attempts in 1 minute"

5. **Sarah Investigates** (11:47 AM)
   - Sarah sees PagerDuty notification on phone
   - Opens SecurityDashboard on laptop
   - Access Denials panel shows spike at 11:45 AM

6. **Drill Down**
   - Clicks spike â†’ AuditViewer opens with filters pre-applied
   - Sees 5 denied delete attempts:
     - obs_123, obs_124, obs_125, obs_126, obs_127
   - All within 30 seconds (automated script?)

7. **Check User Context**
   - Clicks usr_contractor_ext link
   - User details:
     - Role: Editor (limited to upl_project_alpha)
     - IP: 203.0.113.42 (different from usual 192.168.1.x)
     - User Agent: "curl/7.64.1" (API client, not web browser)
   - **Suspicious:** IP from foreign country, using API client (not normal)

8. **Take Action**
   - Sarah clicks "Lock Account" button
   - Confirmation dialog: "Lock usr_contractor_ext? User will not be able to log in until unlocked."
   - Sarah confirms

9. **User Locked**
   - usr_contractor_ext role revoked
   - Email sent: "Your account has been locked due to suspicious activity. Contact security@acme.com to unlock."
   - Audit log: action="account_lock", reason="Suspicious failed access pattern"

10. **Incident Created**
   - Sarah clicks "Create Incident"
   - Title: "Contractor account compromise suspected"
   - Description: "5 failed delete attempts from foreign IP using API client"
   - Assigned to: Security team
   - Priority: High

11. **Follow-Up** (Next Day)
   - Security team contacts contractor
   - Contractor confirms: Laptop stolen, API keys compromised
   - Action: Rotate all API keys, contractor uses new device
   - Account unlocked after verification

**Outcome:** Automated detection + quick response prevented unauthorized data deletion

---

## Wireframes

### Wireframe 1: SecurityDashboard (4-Panel Layout)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Dashboard                      [24h â–¼] [Refresh: 60s â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Access Denials (24h)     â”‚  â”‚ PII Activity (Recent)            â”‚ â”‚
â”‚ â”‚                          â”‚  â”‚                                  â”‚ â”‚
â”‚ â”‚  ^                       â”‚  â”‚ User        Resource    Reason   â”‚ â”‚
â”‚ â”‚ 15â”‚         â—            â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ 10â”‚      â—  â”‚            â”‚  â”‚ usr_owner   obs_123    Fraud...  â”‚ â”‚
â”‚ â”‚  5â”‚   â—  â”‚  â”‚      â—     â”‚  â”‚ usr_admin   obs_456    Support.. â”‚ â”‚
â”‚ â”‚  0â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  â”‚                                  â”‚ â”‚
â”‚ â”‚    12a  6a  12p  6p  12a â”‚  â”‚ [Show All]                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Security Events Timeline â”‚  â”‚ User Activity Heatmap            â”‚ â”‚
â”‚ â”‚                          â”‚  â”‚                                  â”‚ â”‚
â”‚ â”‚ 11:45 âš ï¸ 5 failed access â”‚  â”‚     Mon Tue Wed Thu Fri Sat Sun  â”‚ â”‚
â”‚ â”‚       usr_contractor     â”‚  â”‚ 00h â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘  â”‚ â”‚
â”‚ â”‚                          â”‚  â”‚ 06h â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘  â”‚ â”‚
â”‚ â”‚ 09:30 âœ… Key rotation    â”‚  â”‚ 12h â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–‘â–‘â–‘ â–‘â–‘â–‘  â”‚ â”‚
â”‚ â”‚       system             â”‚  â”‚ 18h â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘â–‘  â”‚ â”‚
â”‚ â”‚                          â”‚  â”‚                                  â”‚ â”‚
â”‚ â”‚ [View All Events]        â”‚  â”‚ Legend: â–‘ Low â–“ Med â–ˆâ–ˆâ–ˆ High     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 2: RoleManager (User List + Permission Preview)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Role Manager                                      [Add User] [Bulk] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search: [________________] Filter: [All Roles â–¼]  Sort: [Name â–¼]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ User                  Role              Scope         Expires       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ usr_sarah_admin      Owner             Tenant-wide   Never         â”‚
â”‚ usr_jane_editor      Editor            Tenant-wide   Never         â”‚
â”‚ usr_fiona_acct       Accountant RO     Tenant-wide   Never         â”‚
â”‚ usr_contractor_ext   [Editor â–¼]        Upload Alpha  2025-12-31    â”‚
â”‚ usr_auditor_carlos   Auditor           Audit logs    2026-06-30    â”‚
â”‚                                                                      â”‚
â”‚ [1] [2] [3] ... [10]   Showing 1-25 of 234 users                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Permission Preview (Hovering over "Editor" role)                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Editor Role Permissions:                                         â”‚â”‚
â”‚ â”‚                                                                  â”‚â”‚
â”‚ â”‚ âœ… Upload documents                                              â”‚â”‚
â”‚ â”‚ âœ… Run parsers                                                   â”‚â”‚
â”‚ â”‚ âœ… Read observations                                             â”‚â”‚
â”‚ â”‚ âœ… Write observations                                            â”‚â”‚
â”‚ â”‚ âŒ Delete observations                                           â”‚â”‚
â”‚ â”‚ âŒ Manage users                                                  â”‚â”‚
â”‚ â”‚ âŒ Unmask PII                                                    â”‚â”‚
â”‚ â”‚ âŒ Export data                                                   â”‚â”‚
â”‚ â”‚                                                                  â”‚â”‚
â”‚ â”‚ PII Masking: All PII fields masked (account, SSN, email, phone) â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 3: AuditViewer (Filtered Log Table)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Audit Logs                                    [Export â–¼] [Settings] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Date Range: [Oct 1 - Oct 25 â–¼]   Event Type: [security_event â–¼]   â”‚
â”‚ User: [usr_contractor â–¼]          Result: [denied â–¼]               â”‚
â”‚                                               [Apply Filters] [Clear]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Time        User              Action  Resource      Result  Reason  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 11:45:03    usr_contractor    delete  obs_123      denied  No perm â”‚
â”‚ 11:45:04    usr_contractor    delete  obs_124      denied  No perm â”‚
â”‚ 11:45:05    usr_contractor    delete  obs_125      denied  No perm â”‚
â”‚ 09:30:12    usr_owner         unmask  obs_456      success Fraud   â”‚
â”‚ 08:15:45    usr_admin         assign  usr_new      success New hireâ”‚
â”‚                                                                      â”‚
â”‚ [â—„] [1] [2] [3] ... [47] [â–º]   Showing 1-20 of 940 events          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Event Detail (Expanded row: 11:45:03 usr_contractor delete)         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Event ID: ae_123e4567...                                         â”‚â”‚
â”‚ â”‚ Type: security_event                                             â”‚â”‚
â”‚ â”‚ Timestamp: 2025-10-25T11:45:03.456Z                              â”‚â”‚
â”‚ â”‚ User: usr_contractor (Role: Editor)                              â”‚â”‚
â”‚ â”‚ IP: 203.0.113.42 (Geo: Foreign Country)                          â”‚â”‚
â”‚ â”‚ User Agent: curl/7.64.1                                          â”‚â”‚
â”‚ â”‚ Action: DELETE /observations/obs_123                             â”‚â”‚
â”‚ â”‚ Result: 403 Forbidden                                            â”‚â”‚
â”‚ â”‚ Reason: Role 'editor' does not have 'delete' permission          â”‚â”‚
â”‚ â”‚                                                                  â”‚â”‚
â”‚ â”‚ [Create Incident] [Lock Account] [View User Details]            â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 4: PII Unmask Dialog (with Reason Requirement)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Unmask PII                                     [X]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚ You are about to view unmasked PII for:               â”‚
â”‚                                                        â”‚
â”‚   Resource: obs_789                                    â”‚
â”‚   Fields: account_number, ssn                         â”‚
â”‚                                                        â”‚
â”‚ âš ï¸ This action will be logged for audit compliance.    â”‚
â”‚                                                        â”‚
â”‚ Why do you need to view unmasked data? (Required)     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Customer reported payment failure for invoice      â”‚ â”‚
â”‚ â”‚ #12345. Need to verify account number matches     â”‚ â”‚
â”‚ â”‚ bank records. Support ticket: TICKET-789.          â”‚ â”‚
â”‚ â”‚                                                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ Character count: 147 / 500                             â”‚
â”‚                                                        â”‚
â”‚ [ ] I confirm this request is necessary and compliant â”‚
â”‚                                                        â”‚
â”‚              [Cancel]           [Confirm & Unmask]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 5: Role Assignment Dialog (with Expiration)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Assign Role                                    [X]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚ User: contractor@external.com                          â”‚
â”‚                                                        â”‚
â”‚ Role: [Editor â–¼]                                       â”‚
â”‚       â”œ Owner (Full access)                            â”‚
â”‚       â”œ Editor (Create/edit) â—„ Selected               â”‚
â”‚       â”œ Viewer (Read-only)                             â”‚
â”‚       â”œ Accountant (Read financial, PII masked)        â”‚
â”‚       â”” Auditor (Audit logs only)                      â”‚
â”‚                                                        â”‚
â”‚ Scope: âšª Tenant-wide  âšª Specific resource             â”‚
â”‚                                                        â”‚
â”‚   Resource Type: [Upload â–¼]                            â”‚
â”‚   Resource ID: [upl_project_alpha â–¼]                   â”‚
â”‚                                                        â”‚
â”‚ Expiration (Optional):                                 â”‚
â”‚   [ğŸ“… 2025-12-31]  (Contract ends)                     â”‚
â”‚                                                        â”‚
â”‚ Permissions Preview:                                   â”‚
â”‚   âœ… Upload documents to Project Alpha                 â”‚
â”‚   âœ… Read/write observations in Project Alpha          â”‚
â”‚   âŒ Cannot delete observations                        â”‚
â”‚   âŒ Cannot access other uploads                       â”‚
â”‚                                                        â”‚
â”‚ [ ] Send email notification to user                   â”‚
â”‚                                                        â”‚
â”‚              [Cancel]              [Assign Role]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 6: Access Denied Error (403 Page)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                        â”‚
â”‚                        â›”                               â”‚
â”‚                  Access Denied                         â”‚
â”‚                                                        â”‚
â”‚  You do not have permission to perform this action.   â”‚
â”‚                                                        â”‚
â”‚  Action attempted: Delete observation                  â”‚
â”‚  Resource: obs_123                                     â”‚
â”‚  Your role: Editor                                     â”‚
â”‚  Required role: Owner                                  â”‚
â”‚                                                        â”‚
â”‚  This incident has been logged for security review.   â”‚
â”‚                                                        â”‚
â”‚  If you believe you should have access, please:       â”‚
â”‚  â€¢ Contact your administrator                          â”‚
â”‚  â€¢ Reference incident: INC-20251025-114503            â”‚
â”‚                                                        â”‚
â”‚         [Request Access] [Back to Dashboard]          â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 7: Security Alert Notification (Slack Format)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SecurityBot  11:46 AM                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ *Security Alert: High Failed Access Rate*           â”‚
â”‚                                                        â”‚
â”‚ *User:* usr_contractor_ext                             â”‚
â”‚ *Time:* 2025-10-25 11:45 AM                            â”‚
â”‚ *Details:* 5 failed access attempts in 1 minute        â”‚
â”‚                                                        â”‚
â”‚ *Attempted Actions:*                                   â”‚
â”‚ â€¢ DELETE obs_123 (denied)                              â”‚
â”‚ â€¢ DELETE obs_124 (denied)                              â”‚
â”‚ â€¢ DELETE obs_125 (denied)                              â”‚
â”‚ â€¢ DELETE obs_126 (denied)                              â”‚
â”‚ â€¢ DELETE obs_127 (denied)                              â”‚
â”‚                                                        â”‚
â”‚ *Context:*                                             â”‚
â”‚ â€¢ IP: 203.0.113.42 (Foreign Country)                   â”‚
â”‚ â€¢ User Agent: curl/7.64.1 (API client)                 â”‚
â”‚ â€¢ Normal IP: 192.168.1.x (Office)                      â”‚
â”‚                                                        â”‚
â”‚ *Recommended Actions:*                                 â”‚
â”‚ 1. Review audit logs                                   â”‚
â”‚ 2. Contact user to verify activity                     â”‚
â”‚ 3. Consider locking account if compromised             â”‚
â”‚                                                        â”‚
â”‚ [View Dashboard] [Lock Account] [Mark Resolved]       â”‚
â”‚                                                        â”‚
â”‚ 2 reactions                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Wireframe 8: Audit Log Export (CSV/PDF Preview)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Export Audit Logs                              [X]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚ Format: âšª CSV  âšª PDF  âšª JSON                          â”‚
â”‚                                                        â”‚
â”‚ Template (PDF only): [Compliance Report â–¼]             â”‚
â”‚   â”œ Compliance Report (formatted)                      â”‚
â”‚   â”œ Executive Summary                                  â”‚
â”‚   â”œ Detailed Audit Trail                               â”‚
â”‚   â”” Custom (configure fields)                          â”‚
â”‚                                                        â”‚
â”‚ Date Range: Oct 1 - Oct 25, 2025                      â”‚
â”‚ Filters Applied: event_type=security_event, ...        â”‚
â”‚                                                        â”‚
â”‚ Events to Export: 47                                   â”‚
â”‚ Estimated Size: 125 KB                                 â”‚
â”‚                                                        â”‚
â”‚ Include:                                               â”‚
â”‚ [âœ“] Event metadata                                     â”‚
â”‚ [âœ“] User details                                       â”‚
â”‚ [âœ“] IP addresses                                       â”‚
â”‚ [ ] Full error messages                                â”‚
â”‚                                                        â”‚
â”‚ Email Report: [ ] Send to my email when ready         â”‚
â”‚                                                        â”‚
â”‚              [Cancel]              [Export]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Preview (PDF):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ACME Corp                             â”‚
â”‚         Quarterly Compliance Report                    â”‚
â”‚         PII Access Audit (Q3 2025)                     â”‚
â”‚                                                        â”‚
â”‚ Report Period: July 1 - Sept 30, 2025                 â”‚
â”‚ Generated: Oct 15, 2025 by usr_carlos_auditor         â”‚
â”‚                                                        â”‚
â”‚ EXECUTIVE SUMMARY                                      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ Total PII Unmask Events: 47                            â”‚
â”‚ Users with Unmask Permission: 3 (owners)               â”‚
â”‚ Flagged Events: 1 (contractor permission bypass)      â”‚
â”‚                                                        â”‚
â”‚ DETAILED AUDIT TRAIL                                   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ Date        User         Resource   Reason            â”‚
â”‚ 2025-09-28  usr_owner    obs_123    Fraud inv. #567   â”‚
â”‚ 2025-09-25  usr_admin    obs_456    Support #789      â”‚
â”‚ ...                                                    â”‚
â”‚                                                        â”‚
â”‚                                               Page 1/3 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Interaction Patterns

### Pattern 1: Permission-Based UI (Show/Hide Actions)

**Principle:** Only show actions user has permission to perform

**Example:** Delete button only visible to owners

```typescript
{user.role === 'owner' && (
  <Button onClick={handleDelete}>Delete</Button>
)}
```

### Pattern 2: Just-In-Time MFA (High-Risk Actions)

**Principle:** Re-authenticate for sensitive actions (unmask PII, role changes)

**Flow:**
1. User clicks "Unmask PII"
2. System prompts for MFA code
3. User enters code
4. Action proceeds if code valid

### Pattern 3: Audit-First Design (Log Before Action)

**Principle:** Write audit log BEFORE performing action (ensures logging even if action fails)

**Flow:**
1. User submits action
2. Create audit log: `result=pending`
3. Perform action
4. Update audit log: `result=success` or `result=failure`

### Pattern 4: Progressive Disclosure (Summary â†’ Details)

**Principle:** Show aggregated metrics first, drill down on demand

**Example:** SecurityDashboard shows spike in chart â†’ Click spike â†’ See individual events

### Pattern 5: Contextual Help (Explain Permissions)

**Principle:** Explain WHY access denied, HOW to request access

**Example:** 403 page shows: "Required role: Owner. Your role: Editor. Contact admin@acme.com to request access."

---

## Accessibility

### Keyboard Navigation

- **Tab Order:** Logical flow (top-to-bottom, left-to-right)
- **Shortcuts:**
  - `/` - Focus search field
  - `Esc` - Close dialog
  - `Enter` - Submit form
  - `Ctrl+E` - Export data
  - `Ctrl+F` - Filter logs

### Screen Reader Support

- **ARIA Labels:** All buttons, inputs labeled
- **ARIA Live Regions:** Security alerts announced
- **Table Headers:** Proper `<thead>` for audit log table
- **Form Validation:** Error messages linked to fields

### High Contrast Mode

- **Color Blind Safe:** Red/green replaced with icons (âœ…âŒ)
- **Focus Indicators:** 3px outline on focused elements
- **Minimum Contrast:** 4.5:1 for normal text, 3:1 for large text

---

## Performance

### SecurityDashboard

- **Initial Load:** <1.5s (4 panels loaded in parallel)
- **Auto-Refresh:** <800ms per panel (cached data)
- **Chart Render:** <300ms for 24h data (1440 data points)

### RoleManager

- **Load Users:** <1s for 1000 users (paginated, 25 per page)
- **Role Assignment:** <500ms (optimistic UI update)
- **Permission Preview:** <50ms (precomputed)

### AuditViewer

- **Load Events:** <1s for 1000 events (virtualized table)
- **Filter Apply:** <200ms (indexed queries)
- **Export:** <5s for 1-year logs (10K events)

---

## Edge Cases

### Edge Case 1: Permission Changes During Session

**Problem:** User's role changed while logged in, sees stale permissions

**Solution:**
- Poll for permission changes every 5 minutes
- If role changed, show banner: "Your permissions have changed. Reload to apply."
- Force reload if permission downgraded (prevent unauthorized access)

### Edge Case 2: Audit Log Tampering Detected

**Problem:** Integrity verification fails, tampering suspected

**Solution:**
- Lock all accounts immediately
- Alert security team (PagerDuty critical alert)
- Display message: "System locked due to security incident. Contact security."
- Freeze audit logs (no new writes until incident resolved)

### Edge Case 3: MFA Timeout During Unmask Flow

**Problem:** User completes MFA but takes 10 minutes to confirm unmask (MFA expires)

**Solution:**
- MFA token valid for 5 minutes only
- If expired, show error: "MFA expired. Please re-authenticate."
- User re-enters MFA code, flow continues

### Edge Case 4: Bulk Role Assignment Partial Failure

**Problem:** Assigning role to 100 users, 5 fail (email invalid)

**Solution:**
- Show progress bar during bulk operation
- If failures, show summary: "95 succeeded, 5 failed. View failed users."
- Allow retry for failed users only

### Edge Case 5: Concurrent Role Changes (Race Condition)

**Problem:** Admin A assigns role while Admin B revokes same role simultaneously

**Solution:**
- Optimistic locking: Each policy has `version` field
- Update only if `version` matches expected value
- If conflict, show error: "Role was modified by another user. Refresh and retry."

---

## Multi-Domain Examples

### Domain 1: Finance (Bank Statements)

**User:** Accountant (Read-Only)
**Use Case:** Review monthly expenses
**PII Masking:** account_number, ssn, routing_number
**Compliance:** SOX (7-year audit retention)

**Flow:**
1. Accountant logs in â†’ Sees dashboard with masked PII
2. Queries October transactions â†’ 1,247 observations
3. Opens obs_456 â†’ account_number shows ****1234
4. Exports to CSV â†’ PII remains masked in export
5. Audit log: data_access, masked_fields=["account_number", "ssn"]

---

### Domain 2: Healthcare (Lab Reports)

**User:** Doctor
**Use Case:** Access patient lab results
**PII Masking:** patient_id, mrn (Medical Record Number), ssn
**Compliance:** HIPAA (6-year audit retention, PHI protection)

**Flow:**
1. Doctor logs in â†’ Role: Editor (can read patient data)
2. Searches patient: "John Doe, DOB 1985-05-15"
3. Opens lab report obs_789 â†’ mrn shows PAT-****1234
4. Doctor needs full MRN for prescription â†’ Clicks "Unmask"
5. Enters reason: "Prescribing medication, need full patient ID"
6. MFA required â†’ Enters 2FA code
7. MRN unmasked: PAT-12345678
8. Audit log: security_event, action=unmask_pii, reason="Prescribing..."

---

### Domain 3: Legal (Court Documents)

**User:** Paralegal
**Use Case:** Research case documents
**PII Masking:** case_number, client_id, ssn
**Compliance:** Attorney-client privilege, bar association rules

**Flow:**
1. Paralegal logs in â†’ Role: Viewer (read-only, PII masked)
2. Searches case: "Smith v. Jones 2025"
3. Opens case doc obs_123 â†’ case_number shows CASE-****5432
4. Paralegal needs full case number for filing â†’ Cannot unmask (not authorized)
5. Clicks "Request Access" â†’ Email sent to attorney
6. Attorney approves â†’ Temporarily grants paralegal unmask permission
7. Paralegal unmasks, completes filing
8. Permission auto-expires after 24 hours

---

### Domain 4: HR (Employee Records)

**User:** HR Manager
**Use Case:** Review employee data
**PII Masking:** employee_id, ssn, salary, bank_account
**Compliance:** GDPR (EU), CCPA (California), privacy regulations

**Flow:**
1. HR Manager logs in â†’ Role: Owner (full access)
2. Opens employee record obs_456 â†’ All fields unmasked
3. Employee requests salary info â†’ HR exports employee record
4. Export includes: employee_id, salary (unmasked for owner)
5. Audit log: data_access, user=usr_hr_manager, resource=obs_456
6. Employee terminates â†’ HR Manager revokes all access
7. Audit log: user_action, action=role_revoke, reason="Employment terminated"

---

### Domain 5: E-commerce (Customer Orders)

**User:** Customer Support
**Use Case:** Debug order issue
**PII Masking:** credit_card, email, phone
**Compliance:** PCI-DSS (Payment Card Industry Data Security Standard)

**Flow:**
1. Support engineer logs in â†’ Role: Viewer (PII masked)
2. Customer calls: "My order #12345 failed"
3. Support searches order obs_12345 â†’ credit_card shows **** **** **** 3456
4. Support needs to verify payment method â†’ Cannot unmask (not authorized)
5. Escalates to finance team (Owner role)
6. Finance unmasks credit_card, verifies with bank
7. Audit log: security_event, action=unmask_pii, alert_triggered=true

---

### Domain 6: Government (Citizen Records)

**User:** Government Clerk
**Use Case:** Process citizen application
**PII Masking:** citizen_id, passport_number, ssn, classified_data
**Compliance:** FISMA (Federal Information Security Management Act)

**Flow:**
1. Clerk logs in â†’ Role: Editor (limited access)
2. Opens citizen application obs_789 â†’ citizen_id shows CID-****1234
3. Needs full ID for verification â†’ Unmask requires supervisor approval
4. Supervisor (Owner) logs in, approves unmask
5. Clerk views full citizen_id: CID-12345678
6. Processes application, data auto re-masks after 5 minutes
7. Audit log: security_event, action=unmask_pii, approved_by=usr_supervisor

---

### Domain 7: SaaS (User Accounts)

**User:** Support Engineer
**Use Case:** Debug user issue
**PII Masking:** api_key, user_token, email, phone
**Compliance:** SOC 2 (Service Organization Control 2)

**Flow:**
1. Support engineer logs in â†’ Role: Viewer (PII masked)
2. User reports: "API returning 401 errors"
3. Support searches user account obs_456 â†’ api_key shows sk_live_****xyz
4. Cannot debug without full API key â†’ Escalates to security team
5. Security team (Owner) unmasks API key, identifies issue: key expired
6. Security team rotates key, provides new key to user
7. Audit log: security_event, action=unmask_pii, action=key_rotation

---

## Summary

This UX flow document defines the complete user experience for **Vertical 5.4: Security & Access**, covering:

- **6 User Journeys** - Security monitoring, role management, audit review, PII unmask, access denied, security alerts
- **8 Wireframes** - SecurityDashboard, RoleManager, AuditViewer, dialogs, error pages, notifications
- **5 Interaction Patterns** - Permission-based UI, just-in-time MFA, audit-first, progressive disclosure, contextual help
- **Accessibility** - Keyboard nav, screen reader support, high contrast mode
- **Performance** - <1.5s dashboard load, <1s audit log query, <5s exports
- **7 Edge Cases** - Permission changes, tampering detection, MFA timeout, bulk failures, race conditions
- **7 Multi-Domain Examples** - Finance, Healthcare, Legal, HR, E-commerce, Government, SaaS

All flows maintain **defense in depth** (masking + encryption + access control + audit) and **fail secure** principles.
