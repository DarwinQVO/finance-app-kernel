# UX Flow 3.1: Account Registry Experience

> **Vertical:** 3.1 Account Registry (closed registry of user's financial accounts)
> **Dependencies:** 2.1 Transaction List View (account filter), 2.2 OL Exploration (transaction edit uses account selector)
> **User Story:** As a user, I want to manage my financial accounts (checking, credit cards, cash) so I can properly categorize transactions and track balances across institutions.

---

## User Journeys

### Journey 1: New User Adds First Three Accounts

**Context:** User just signed up and is setting up their financial tracking system. They have transactions from three accounts: BofA Checking, BofA Credit Card, and Apple Card.

**Steps:**

1. **Entry point:** User navigates to Settings > Accounts
   - URL: `/settings/accounts`
   - System shows empty state (no accounts registered yet)
   - Empty state screen:
     ```
     ┌────────────────────────────────────────────────────┐
     │                        📦                          │
     │                                                    │
     │              Add Your First Account                │
     │                                                    │
     │    Start by adding the accounts you use to track   │
     │    transactions. You can add bank accounts, credit │
     │    cards, and cash accounts.                       │
     │                                                    │
     │              [+ Add First Account]                 │
     │                                                    │
     │    Need help? Learn about account types →          │
     └────────────────────────────────────────────────────┘
     ```

2. **User clicks "Add First Account":**
   - Create Account modal opens
   - Focus automatically on "Account Name" field
   - Modal shows:
     ```
     ┌────────────────────────────────────────────┐
     │ Create Account                         × │
     ├────────────────────────────────────────────┤
     │ Account Name *                             │
     │ [____________________________________]     │
     │                                            │
     │ Account Type *                             │
     │ [Checking ▼]                               │
     │                                            │
     │ Currency *                                 │
     │ [USD - US Dollar ▼]                        │
     │                                            │
     │ Institution (optional)                     │
     │ [____________________________________]     │
     │                                            │
     │ Notes (optional)                           │
     │ [____________________________________]     │
     │                                            │
     │ Initial Balance                            │
     │ [$0.00_______________________________]     │
     │                                            │
     │ [Cancel]                  [Create Account] │
     └────────────────────────────────────────────┘
     ```

3. **User creates BofA Checking account:**
   - Types: "BofA Checking"
   - Selects: "Checking" (already selected by default)
   - Selects: "USD - US Dollar" (already selected by default)
   - Types institution: "Bank of America"
   - Leaves initial balance: $0.00 (will be calculated from transactions)
   - Clicks "Create Account"

4. **Account created successfully:**
   - Modal closes with fade-out animation (200ms)
   - Success toast appears: "✅ Account 'BofA Checking' created"
   - Account list view loads:
     ```
     ┌────────────────────────────────────────────────────┐
     │ Accounts (1)                    [+ New Account]    │
     ├────────────────────────────────────────────────────┤
     │ Search accounts... [____________] [Filter ▼]       │
     ├────────────────────────────────────────────────────┤
     │                                                    │
     │ CHECKING ACCOUNTS (1)                              │
     │ ┌──────────────────────────────────────────────┐   │
     │ │ BofA Checking                           USD  │   │
     │ │ Bank of America                              │   │
     │ │ Balance: $0.00  •  0 transactions            │   │
     │ │                                              │   │
     │ │ [Edit] [Archive]                             │   │
     │ └──────────────────────────────────────────────┘   │
     │                                                    │
     └────────────────────────────────────────────────────┘
     ```

5. **User adds second account (BofA Credit):**
   - Clicks "+ New Account" button
   - Modal opens (same as before)
   - Types: "BofA Credit"
   - Selects: "Credit Card"
   - Selects: "USD"
   - Types institution: "Bank of America"
   - Clicks "Create Account"
   - Success toast: "✅ Account 'BofA Credit' created"

6. **User adds third account (Apple Card):**
   - Clicks "+ New Account"
   - Types: "Apple Card"
   - Selects: "Credit Card"
   - Selects: "USD"
   - Types institution: "Apple"
   - Clicks "Create Account"
   - Success toast: "✅ Account 'Apple Card' created"

7. **Final account list view:**
   ```
   ┌────────────────────────────────────────────────────┐
   │ Accounts (3)                    [+ New Account]    │
   ├────────────────────────────────────────────────────┤
   │ Search accounts... [____________] [Filter ▼]       │
   ├────────────────────────────────────────────────────┤
   │                                                    │
   │ CHECKING ACCOUNTS (1)                              │
   │ ┌──────────────────────────────────────────────┐   │
   │ │ BofA Checking                           USD  │   │
   │ │ Bank of America                              │   │
   │ │ Balance: $0.00  •  0 transactions            │   │
   │ │                                              │   │
   │ │ [Edit] [Archive]                             │   │
   │ └──────────────────────────────────────────────┘   │
   │                                                    │
   │ CREDIT CARD ACCOUNTS (2)                           │
   │ ┌──────────────────────────────────────────────┐   │
   │ │ Apple Card                              USD  │   │
   │ │ Apple                                        │   │
   │ │ Balance: $0.00  •  0 transactions            │   │
   │ │                                              │   │
   │ │ [Edit] [Archive]                             │   │
   │ └──────────────────────────────────────────────┘   │
   │                                                    │
   │ ┌──────────────────────────────────────────────┐   │
   │ │ BofA Credit                             USD  │   │
   │ │ Bank of America                              │   │
   │ │ Balance: $0.00  •  0 transactions            │   │
   │ │                                              │   │
   │ │ [Edit] [Archive]                             │   │
   │ └──────────────────────────────────────────────┘   │
   │                                                    │
   └────────────────────────────────────────────────────┘
   ```

**Outcome:** User successfully added three accounts. Accounts are grouped by type and sorted alphabetically within groups. User is ready to assign transactions to these accounts.

**Duration:** ~3 minutes

---

### Journey 2: User Edits Account Name

**Context:** User realizes they have multiple BofA accounts and wants to rename "BofA Checking" to "BofA Personal Checking" for clarity.

**Steps:**

1. **Entry point:** User on Accounts page (`/settings/accounts`)
   - User sees three accounts from Journey 1
   - User identifies: "BofA Checking is my personal account, need to clarify"

2. **User clicks "Edit" button on BofA Checking card:**
   - Edit Account modal opens
   - Modal pre-filled with existing values:
     ```
     ┌────────────────────────────────────────────┐
     │ Edit Account                           × │
     ├────────────────────────────────────────────┤
     │ Account Name *                             │
     │ [BofA Checking_______________________]     │
     │                                            │
     │ Account Type                               │
     │ [Checking ▼] (disabled)                    │
     │ ⓘ Cannot change type after creation        │
     │                                            │
     │ Currency                                   │
     │ [USD - US Dollar ▼] (disabled)             │
     │ ⓘ Cannot change currency after creation    │
     │                                            │
     │ Institution (optional)                     │
     │ [Bank of America_____________________]     │
     │                                            │
     │ Notes (optional)                           │
     │ [____________________________________]     │
     │                                            │
     │ Status                                     │
     │ ⦿ Active    ○ Archived                     │
     │                                            │
     │ [Cancel]                     [Save Changes]│
     └────────────────────────────────────────────┘
     ```

3. **User observes restrictions:**
   - Account Type field is disabled (grayed out)
   - Currency field is disabled (grayed out)
   - Tooltip icons (ⓘ) explain: "Cannot change after creation"
   - User thinks: "Makes sense - changing currency would break transaction history"

4. **User edits name:**
   - Clicks into "Account Name" field
   - Selects all text: Cmd+A (Mac) or Ctrl+A (Windows)
   - Types: "BofA Personal Checking"
   - Field now shows: "BofA Personal Checking"

5. **User saves changes:**
   - Clicks "Save Changes" button
   - Modal closes (200ms fade)
   - Success toast: "✅ Account updated successfully"
   - Account list refreshes:
     ```
     CHECKING ACCOUNTS (1)
     ┌──────────────────────────────────────────────┐
     │ BofA Personal Checking                  USD  │
     │ Bank of America                              │
     │ Balance: $0.00  •  0 transactions            │
     │                                              │
     │ [Edit] [Archive]                             │
     └──────────────────────────────────────────────┘
     ```

6. **User verification:**
   - User sees updated name reflected in list
   - User notes: "Perfect. Now I can add a business checking account later."

**Outcome:** User successfully renamed account. System enforced immutability constraints (type, currency) to maintain data integrity.

**Duration:** ~1 minute

---

### Journey 3: User Archives Closed Account

**Context:** User closed their Apple Card last month. They want to archive it (not delete) to maintain historical transaction data.

**Steps:**

1. **Entry point:** User on Accounts page (`/settings/accounts`)
   - User sees three active accounts
   - User remembers: "I closed Apple Card in April. Should archive it."

2. **User clicks "Archive" button on Apple Card:**
   - Archive confirmation dialog appears:
     ```
     ┌────────────────────────────────────────────┐
     │ Archive Account                            │
     ├────────────────────────────────────────────┤
     │ Are you sure you want to archive this      │
     │ account?                                   │
     │                                            │
     │ Account: Apple Card                        │
     │ Institution: Apple                         │
     │                                            │
     │ ⚠️  This account has 127 transactions      │
     │                                            │
     │ Archiving will:                            │
     │ • Hide account from active account lists   │
     │ • Preserve all transaction history         │
     │ • Remove from transaction dropdowns        │
     │ • Keep account visible in filters (show    │
     │   archived option)                         │
     │                                            │
     │ You can restore this account later.        │
     │                                            │
     │ [Cancel]                   [Archive Account]│
     └────────────────────────────────────────────┘
     ```

3. **User reads confirmation details:**
   - User sees: "This account has 127 transactions"
   - User thinks: "Good - it won't delete my history"
   - User reads: "You can restore this account later"
   - User confirms: "Perfect. I might need to reference old statements."

4. **User confirms archive:**
   - Clicks "Archive Account" button
   - Dialog closes (200ms fade)
   - Success toast: "✅ Account 'Apple Card' archived"
   - Account list updates:
     ```
     ┌────────────────────────────────────────────────────┐
     │ Accounts (2)                    [+ New Account]    │
     ├────────────────────────────────────────────────────┤
     │ Search accounts... [____________] [Filter ▼]       │
     │                                   ☐ Show archived  │
     ├────────────────────────────────────────────────────┤
     │                                                    │
     │ CHECKING ACCOUNTS (1)                              │
     │ ┌──────────────────────────────────────────────┐   │
     │ │ BofA Personal Checking                  USD  │   │
     │ │ Bank of America                              │   │
     │ │ Balance: $0.00  •  0 transactions            │   │
     │ │                                              │   │
     │ │ [Edit] [Archive]                             │   │
     │ └──────────────────────────────────────────────┘   │
     │                                                    │
     │ CREDIT CARD ACCOUNTS (1)                           │
     │ ┌──────────────────────────────────────────────┐   │
     │ │ BofA Credit                             USD  │   │
     │ │ Bank of America                              │   │
     │ │ Balance: $0.00  •  0 transactions            │   │
     │ │                                              │   │
     │ │ [Edit] [Archive]                             │   │
     │ └──────────────────────────────────────────────┘   │
     │                                                    │
     └────────────────────────────────────────────────────┘
     ```

5. **User verification:**
   - Account count changed from "(3)" to "(2)"
   - Apple Card no longer visible in active list
   - User sees new filter option: "☐ Show archived"
   - User clicks "Show archived" checkbox
   - Apple Card reappears with archived badge:
     ```
     CREDIT CARD ACCOUNTS (2)
     ┌──────────────────────────────────────────────┐
     │ Apple Card                              USD  │
     │ Apple                            🗄️ ARCHIVED │
     │ Balance: $0.00  •  127 transactions          │
     │                                              │
     │ [Restore] [Delete Permanently]               │
     └──────────────────────────────────────────────┘
     ```

6. **User observes archived state:**
   - User sees "🗄️ ARCHIVED" badge
   - Action buttons changed: "Restore" instead of "Archive"
   - Dangerous action: "Delete Permanently" (red text)
   - User unchecks "Show archived" to hide archived accounts again

**Outcome:** User successfully archived closed account. Historical transactions preserved. Account hidden from active lists but accessible via filter.

**Duration:** ~2 minutes

---

### Journey 4: User Selects Account in Transaction Edit

**Context:** User is editing a transaction and needs to assign it to the correct account. They have 2 active accounts + 1 archived.

**Steps:**

1. **Entry point:** User editing transaction in Transaction List View
   - User on `/transactions` page
   - User clicks "Edit" on a transaction
   - Transaction edit modal opens (vertical 2.2)

2. **User clicks "Account" dropdown:**
   - Account selector expands
   - Shows grouped accounts:
     ```
     ┌────────────────────────────────────────────┐
     │ Edit Transaction                       × │
     ├────────────────────────────────────────────┤
     │ Amount                                     │
     │ [$127.45]                                  │
     │                                            │
     │ Date                                       │
     │ [2025-05-15]                               │
     │                                            │
     │ Account *                                  │
     │ [Select account ▼] ← (clicked)             │
     │  ↓                                         │
     │  ┌──────────────────────────────────────┐  │
     │  │ Search accounts... [____________]    │  │
     │  ├──────────────────────────────────────┤  │
     │  │ CHECKING ACCOUNTS                    │  │
     │  │ ✓ BofA Personal Checking        USD  │  │
     │  │                                      │  │
     │  │ CREDIT CARD ACCOUNTS                 │  │
     │  │   BofA Credit                   USD  │  │
     │  ├──────────────────────────────────────┤  │
     │  │ + Create New Account                 │  │
     │  └──────────────────────────────────────┘  │
     │                                            │
     │ Category                                   │
     │ [Food & Drink ▼]                           │
     │                                            │
     └────────────────────────────────────────────┘
     ```

3. **User observes dropdown structure:**
   - Accounts grouped by type (Checking, Credit Card)
   - Current selection: "BofA Personal Checking" (checkmark ✓)
   - Search field at top for quick filtering
   - Quick action: "+ Create New Account" at bottom
   - Archived accounts NOT shown (by default)

4. **User realizes need for archived account:**
   - User thinks: "Wait, this was on my Apple Card before I closed it"
   - User scrolls to bottom of dropdown
   - User sees: "☐ Show archived accounts"
   - User checks box

5. **Dropdown updates with archived accounts:**
   ```
   ┌──────────────────────────────────────┐
   │ Search accounts... [____________]    │
   ├──────────────────────────────────────┤
   │ CHECKING ACCOUNTS                    │
   │ ✓ BofA Personal Checking        USD  │
   │                                      │
   │ CREDIT CARD ACCOUNTS                 │
   │   BofA Credit                   USD  │
   │   Apple Card (archived)         USD  │
   │                                      │
   ├──────────────────────────────────────┤
   │ + Create New Account                 │
   └──────────────────────────────────────┘
   ```

6. **User selects archived account:**
   - Clicks "Apple Card (archived)"
   - Dropdown closes
   - Account field now shows:
     ```
     Account *
     [Apple Card (archived) ▼]
     ```
   - User notes: "Good - I can still assign transactions to closed accounts"

7. **User saves transaction:**
   - Clicks "Save Transaction"
   - Modal closes
   - Transaction updated with Apple Card account

**Alternative path: User searches for account**

3b. **User uses search instead of scrolling:**
   - Types "apple" in search field
   - Dropdown filters in real-time:
     ```
     ┌──────────────────────────────────────┐
     │ Search accounts... [apple_______]    │
     ├──────────────────────────────────────┤
     │ No active accounts match "apple"     │
     │                                      │
     │ ☐ Show archived accounts             │
     └──────────────────────────────────────┘
     ```
   - User checks "Show archived accounts"
   - Apple Card appears:
     ```
     ┌──────────────────────────────────────┐
     │ Search accounts... [apple_______]    │
     ├──────────────────────────────────────┤
     │ CREDIT CARD ACCOUNTS                 │
     │   Apple Card (archived)         USD  │
     └──────────────────────────────────────┘
     ```
   - User clicks "Apple Card (archived)"

**Outcome:** User successfully selected archived account in transaction edit. System maintains data integrity by allowing historical account assignments.

**Duration:** ~30 seconds (direct selection) or ~1 minute (with search)

---

## Wireframes

### Wireframe 1: Empty State (Desktop)

```
┌────────────────────────────────────────────────────────────────────────┐
│ ☰ Finance App                                                     👤   │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│ Settings > Accounts                                                    │
│                                                                        │
│                                                                        │
│                                                                        │
│                               📦                                       │
│                                                                        │
│                       Add Your First Account                           │
│                                                                        │
│           Start by adding the accounts you use to track                │
│           transactions. You can add bank accounts, credit              │
│           cards, and cash accounts.                                    │
│                                                                        │
│                                                                        │
│                       [+ Add First Account]                            │
│                                                                        │
│                                                                        │
│                   Need help? Learn about account types →               │
│                                                                        │
│                                                                        │
│ ─────────────────────────────────────────────────────────────────────  │
│ Account Types:                                                         │
│ • Checking: Day-to-day spending accounts                              │
│ • Savings: Long-term savings accounts                                 │
│ • Credit Card: Credit card accounts (track spending & payments)       │
│ • Cash: Physical cash tracking                                        │
│ • Investment: Brokerage and investment accounts                       │
│ • Loan: Mortgages, car loans, student loans                           │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

---

### Wireframe 2: Account List View (3-10 Accounts) - Desktop

```
┌────────────────────────────────────────────────────────────────────────┐
│ ☰ Finance App                                                     👤   │
├────────────────────────────────────────────────────────────────────────┤
│ Settings > Accounts                                                    │
│                                                                        │
│ Accounts (5)                                       [+ New Account]     │
├────────────────────────────────────────────────────────────────────────┤
│ Search accounts... [________________________] [Filter ▼]              │
│                                                ☐ Show archived         │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│ CHECKING ACCOUNTS (2)                                                  │
│ ┌──────────────────────────────────────────────────────────────────┐  │
│ │ BofA Personal Checking                                      USD  │  │
│ │ Bank of America                                                  │  │
│ │ Balance: $3,245.67  •  127 transactions                          │  │
│ │ Last updated: 2 hours ago                                        │  │
│ │                                                                  │  │
│ │ [Edit] [Archive]                                                 │  │
│ └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
│ ┌──────────────────────────────────────────────────────────────────┐  │
│ │ Chase Business Checking                                     USD  │  │
│ │ Chase                                                            │  │
│ │ Balance: $12,840.33  •  342 transactions                         │  │
│ │ Last updated: 5 minutes ago                                      │  │
│ │                                                                  │  │
│ │ [Edit] [Archive]                                                 │  │
│ └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
│ SAVINGS ACCOUNTS (1)                                                   │
│ ┌──────────────────────────────────────────────────────────────────┐  │
│ │ BofA Savings                                                USD  │  │
│ │ Bank of America                                                  │  │
│ │ Balance: $28,500.00  •  18 transactions                          │  │
│ │ Last updated: 1 day ago                                          │  │
│ │                                                                  │  │
│ │ [Edit] [Archive]                                                 │  │
│ └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
│ CREDIT CARD ACCOUNTS (2)                                               │
│ ┌──────────────────────────────────────────────────────────────────┐  │
│ │ BofA Credit                                                 USD  │  │
│ │ Bank of America                                                  │  │
│ │ Balance: -$2,147.89  •  89 transactions                          │  │
│ │ Last updated: 1 hour ago                                         │  │
│ │                                                                  │  │
│ │ [Edit] [Archive]                                                 │  │
│ └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
│ ┌──────────────────────────────────────────────────────────────────┐  │
│ │ Amex Platinum                                               USD  │  │
│ │ American Express                                                 │  │
│ │ Balance: -$4,532.10  •  156 transactions                         │  │
│ │ Last updated: 30 minutes ago                                     │  │
│ │                                                                  │  │
│ │ [Edit] [Archive]                                                 │  │
│ └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

---

### Wireframe 3: Create Account Modal - Desktop

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                   ┌──────────────────────────────────────┐             │
│                   │ Create Account                   × │             │
│                   ├──────────────────────────────────────┤             │
│                   │ Account Name *                       │             │
│                   │ [BofA Personal Checking____________] │             │
│                   │                                      │             │
│                   │ Account Type *                       │             │
│                   │ [Checking ▼]                         │             │
│                   │                                      │             │
│                   │ Currency *                           │             │
│                   │ [USD - US Dollar ▼]                  │             │
│                   │                                      │             │
│                   │ Institution (optional)               │             │
│                   │ [Bank of America___________________] │             │
│                   │                                      │             │
│                   │ Notes (optional)                     │             │
│                   │ [Primary personal checking account_] │             │
│                   │ [for daily expenses________________] │             │
│                   │                                      │             │
│                   │ Initial Balance                      │             │
│                   │ [$0.00_____________________________] │             │
│                   │ ⓘ Leave as $0 if you'll import       │             │
│                   │   transaction history                │             │
│                   │                                      │             │
│                   │ [Cancel]           [Create Account]  │             │
│                   └──────────────────────────────────────┘             │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘

Account Type Dropdown (when clicked):
┌──────────────────────────┐
│ Checking ✓               │
│ Savings                  │
│ Credit Card              │
│ Cash                     │
│ Investment               │
│ Loan                     │
└──────────────────────────┘

Currency Dropdown (when clicked):
┌──────────────────────────┐
│ USD - US Dollar ✓        │
│ MXN - Mexican Peso       │
│ EUR - Euro               │
│ GBP - British Pound      │
│ CAD - Canadian Dollar    │
│ ───────────────────      │
│ [Search currencies...]   │
└──────────────────────────┘
```

---

### Wireframe 4: Edit Account Modal (Pre-filled, Currency/Type Disabled)

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                   ┌──────────────────────────────────────┐             │
│                   │ Edit Account                     × │             │
│                   ├──────────────────────────────────────┤             │
│                   │ Account Name *                       │             │
│                   │ [BofA Personal Checking____________] │             │
│                   │                                      │             │
│                   │ Account Type                         │             │
│                   │ [Checking ▼] (disabled)              │             │
│                   │ ⓘ Cannot change type after creation  │             │
│                   │                                      │             │
│                   │ Currency                             │             │
│                   │ [USD - US Dollar ▼] (disabled)       │             │
│                   │ ⓘ Cannot change currency after       │             │
│                   │   creation to maintain transaction   │             │
│                   │   integrity                          │             │
│                   │                                      │             │
│                   │ Institution (optional)               │             │
│                   │ [Bank of America___________________] │             │
│                   │                                      │             │
│                   │ Notes (optional)                     │             │
│                   │ [Primary personal checking account_] │             │
│                   │ [for daily expenses________________] │             │
│                   │                                      │             │
│                   │ Status                               │             │
│                   │ ⦿ Active    ○ Archived               │             │
│                   │                                      │             │
│                   │ Account Created                      │             │
│                   │ May 15, 2025                         │             │
│                   │                                      │             │
│                   │ [Cancel]              [Save Changes] │             │
│                   └──────────────────────────────────────┘             │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘

Visual indicator of disabled fields:
┌──────────────────────────┐
│ [Checking ▼]             │  ← Grayed out, no cursor change on hover
│ ⓘ Cannot change type...  │  ← Helper text in muted color
└──────────────────────────┘
```

---

### Wireframe 5: Archive Confirmation Dialog

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                                                                        │
│                   ┌──────────────────────────────────────┐             │
│                   │ Archive Account                      │             │
│                   ├──────────────────────────────────────┤             │
│                   │ Are you sure you want to archive     │             │
│                   │ this account?                        │             │
│                   │                                      │             │
│                   │ Account: Apple Card                  │             │
│                   │ Institution: Apple                   │             │
│                   │ Currency: USD                        │             │
│                   │                                      │             │
│                   │ ⚠️  This account has 127 transactions│             │
│                   │                                      │             │
│                   │ Archiving will:                      │             │
│                   │ • Hide account from active lists     │             │
│                   │ • Preserve all transaction history   │             │
│                   │ • Remove from transaction dropdowns  │             │
│                   │ • Keep account visible in filters    │             │
│                   │   (when "Show archived" is enabled)  │             │
│                   │                                      │             │
│                   │ You can restore this account later   │             │
│                   │ from the archived accounts list.     │             │
│                   │                                      │             │
│                   │ [Cancel]          [Archive Account]  │             │
│                   └──────────────────────────────────────┘             │
│                                                                        │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘

High transaction count variation (100+ transactions):
┌──────────────────────────────────────┐
│ ⚠️  This account has 1,247           │
│    transactions                      │
│                                      │
│ Archiving will preserve all history  │
│ but may impact report performance.   │
│                                      │
│ Consider exporting data first.       │
│ [Export Transactions →]              │
└──────────────────────────────────────┘
```

---

### Wireframe 6: Account Selector Dropdown (Collapsed) - In Transaction Edit

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                   ┌──────────────────────────────────────┐             │
│                   │ Edit Transaction                 × │             │
│                   ├──────────────────────────────────────┤             │
│                   │ Date                                 │             │
│                   │ [2025-05-23▼]                        │             │
│                   │                                      │             │
│                   │ Amount *                             │             │
│                   │ [$127.45___________________________] │             │
│                   │                                      │             │
│                   │ Account *                            │             │
│                   │ [BofA Personal Checking ▼]           │             │
│                   │                                      │             │
│                   │ Category *                           │             │
│                   │ [Food & Drink ▼]                     │             │
│                   │                                      │             │
│                   │ Merchant                             │             │
│                   │ [Uber Eats_________________________] │             │
│                   │                                      │             │
│                   │ Notes                                │             │
│                   │ [Lunch meeting with client________] │             │
│                   │                                      │             │
│                   │ [Cancel]          [Save Transaction] │             │
│                   └──────────────────────────────────────┘             │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

---

### Wireframe 7: Account Selector Dropdown (Expanded with Grouping)

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                   ┌──────────────────────────────────────┐             │
│                   │ Edit Transaction                 × │             │
│                   ├──────────────────────────────────────┤             │
│                   │ Date                                 │             │
│                   │ [2025-05-23▼]                        │             │
│                   │                                      │             │
│                   │ Amount *                             │             │
│                   │ [$127.45___________________________] │             │
│                   │                                      │             │
│                   │ Account *                            │             │
│                   │ [BofA Personal Checking ▼] ← clicked │             │
│                   │  ↓                                   │             │
│                   │  ┌────────────────────────────────┐  │             │
│                   │  │ Search accounts... [_________] │  │             │
│                   │  ├────────────────────────────────┤  │             │
│                   │  │ CHECKING ACCOUNTS              │  │             │
│                   │  │ ✓ BofA Personal Checking  USD  │  │             │
│                   │  │   Chase Business Checking USD  │  │             │
│                   │  │                                │  │             │
│                   │  │ SAVINGS ACCOUNTS               │  │             │
│                   │  │   BofA Savings            USD  │  │             │
│                   │  │                                │  │             │
│                   │  │ CREDIT CARD ACCOUNTS           │  │             │
│                   │  │   BofA Credit             USD  │  │             │
│                   │  │   Amex Platinum           USD  │  │             │
│                   │  ├────────────────────────────────┤  │             │
│                   │  │ ☐ Show archived accounts       │  │             │
│                   │  ├────────────────────────────────┤  │             │
│                   │  │ + Create New Account           │  │             │
│                   │  └────────────────────────────────┘  │             │
│                   │                                      │             │
│                   │ Category *                           │             │
│                   │ [Food & Drink ▼]                     │             │
│                   │                                      │             │
│                   └──────────────────────────────────────┘             │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘

With "Show archived" enabled:
┌────────────────────────────────────┐
│ CHECKING ACCOUNTS                  │
│ ✓ BofA Personal Checking      USD  │
│   Chase Business Checking     USD  │
│                                    │
│ CREDIT CARD ACCOUNTS               │
│   BofA Credit                 USD  │
│   Amex Platinum               USD  │
│   Apple Card (archived)       USD  │ ← Italicized with badge
├────────────────────────────────────┤
│ ☑ Show archived accounts           │
├────────────────────────────────────┤
│ + Create New Account               │
└────────────────────────────────────┘
```

---

### Wireframe 8: Account Selector in Transaction Edit Context (Mobile)

```
┌──────────────────────────┐
│ ← Edit Transaction       │
├──────────────────────────┤
│ Date                     │
│ [2025-05-23▼]            │
│                          │
│ Amount *                 │
│ [$127.45_______________] │
│                          │
│ Account *                │
│ [BofA Personal... ▼]     │ ← Tapped
│  ↓                       │
│  ┌────────────────────┐  │
│  │ Search...          │  │
│  ├────────────────────┤  │
│  │ CHECKING           │  │
│  │ ✓ BofA Personal    │  │
│  │   Chase Business   │  │
│  │                    │  │
│  │ SAVINGS            │  │
│  │   BofA Savings     │  │
│  │                    │  │
│  │ CREDIT CARD        │  │
│  │   BofA Credit      │  │
│  │   Amex Platinum    │  │
│  ├────────────────────┤  │
│  │ ☐ Show archived    │  │
│  ├────────────────────┤  │
│  │ + New Account      │  │
│  └────────────────────┘  │
│                          │
│ Category *               │
│ [Food & Drink ▼]         │
│                          │
│ Merchant                 │
│ [Uber Eats_____________] │
│                          │
│ [Cancel] [Save]          │
└──────────────────────────┘

Search interaction (user types "chase"):
┌────────────────────┐
│ [chase_________]   │ ← Search term
├────────────────────┤
│ CHECKING           │
│   Chase Business   │ ← Only matching result
├────────────────────┤
│ No other matches   │
└────────────────────┘
```

---

## Interaction Details

### Keyboard Shortcuts

**Accounts List Page:**
- `N` → Open "New Account" modal (when not in input field)
- `Cmd/Ctrl + F` → Focus search box
- `ESC` → Clear search (if search active), or navigate back
- `↓` / `↑` → Navigate between account cards (when search focused)
- `Enter` → Open edit modal for focused account
- `/` → Focus search box (alternative to Cmd/Ctrl+F)

**Create/Edit Account Modal:**
- `Tab` → Move to next field
- `Shift + Tab` → Move to previous field
- `ESC` → Close modal (if no unsaved changes)
- `Cmd/Ctrl + Enter` → Save account (from any field)
- `Cmd/Ctrl + S` → Save account (alternative)

**Account Selector Dropdown (in transaction edit):**
- `↓` / `↑` → Navigate options
- `Enter` → Select highlighted account
- `ESC` → Close dropdown without selecting
- `Type to search` → Filter accounts in real-time
- `Tab` → Close dropdown and move to next field

---

### Validation Feedback

**Account Name Validation:**

```
Duplicate name error:
┌──────────────────────────────────────┐
│ Account Name *                       │
│ [BofA Checking___________________]   │
│ ❌ Account name already exists       │
│                                      │
│ Suggested: BofA Checking 2           │
└──────────────────────────────────────┘

Empty name error:
┌──────────────────────────────────────┐
│ Account Name *                       │
│ [________________________________]   │
│ ❌ Account name is required          │
└──────────────────────────────────────┘

Name too long error (> 100 chars):
┌──────────────────────────────────────┐
│ Account Name *                       │
│ [My Very Long Account Name That...   │
│ ❌ Name must be 100 characters or    │
│    less (currently 127)              │
└──────────────────────────────────────┘
```

**Currency Validation (in edit modal):**

```
User tries to change currency (immutable field):
┌──────────────────────────────────────┐
│ Currency                             │
│ [USD - US Dollar ▼] (disabled)       │
│ ⓘ Cannot change currency after       │
│   creation to maintain transaction   │
│   integrity                          │
│                                      │
│ [Why can't I change this?]           │ ← Help link
└──────────────────────────────────────┘

Clicking help link shows:
┌──────────────────────────────────────┐
│ Why is currency locked?              │
├──────────────────────────────────────┤
│ Changing an account's currency would │
│ invalidate historical transaction    │
│ amounts and balances.                │
│                                      │
│ If you need to track a different     │
│ currency, create a new account.      │
│                                      │
│ [Got it]                             │
└──────────────────────────────────────┘
```

**Account Type Validation (in edit modal):**

```
User tries to change type (immutable field):
┌──────────────────────────────────────┐
│ Account Type                         │
│ [Checking ▼] (disabled)              │
│ ⓘ Cannot change type after creation  │
│                                      │
│ This prevents transaction            │
│ categorization issues.               │
└──────────────────────────────────────┘
```

---

### Success/Error States

**Account Created Success:**

```
Toast (top-right, auto-dismiss after 3s):
┌──────────────────────────────────────┐
│ ✅ Account 'BofA Checking' created   │
└──────────────────────────────────────┘

Account card animates in (slide from top, 300ms):
┌──────────────────────────────────────────────┐
│ BofA Checking                           USD  │ ← New card
│ Bank of America                              │
│ Balance: $0.00  •  0 transactions            │
│                                              │
│ [Edit] [Archive]                             │
└──────────────────────────────────────────────┘
```

**Account Updated Success:**

```
Toast (top-right, auto-dismiss after 3s):
┌──────────────────────────────────────┐
│ ✅ Account updated successfully      │
└──────────────────────────────────────┘

Updated fields highlight briefly (300ms yellow flash):
┌──────────────────────────────────────────────┐
│ BofA Personal Checking                  USD  │ ← Name changed
│ Bank of America                              │
│ Balance: $3,245.67  •  127 transactions      │
│                                              │
│ [Edit] [Archive]                             │
└──────────────────────────────────────────────┘
```

**Account Archived Success:**

```
Toast (top-right, auto-dismiss after 4s):
┌──────────────────────────────────────────────┐
│ ✅ Account 'Apple Card' archived             │
│ [Undo]                                       │ ← Undo action available
└──────────────────────────────────────────────┘

Account card fades out (300ms):
┌──────────────────────────────────────────────┐
│ Apple Card                              USD  │ ← Fading out
│ Apple                                        │
│ Balance: $0.00  •  127 transactions          │
└──────────────────────────────────────────────┘

If user clicks [Undo] within 4 seconds:
- Archive action reversed
- Account restored to active list
- New toast: "✅ Archive cancelled"
```

**Account Creation Error:**

```
Toast (top-right, stays until dismissed):
┌──────────────────────────────────────────────┐
│ ❌ Failed to create account                  │
│ Database connection error. Try again.        │
│                                              │
│ [Retry] [Dismiss]                            │
└──────────────────────────────────────────────┘

Modal remains open with user's data preserved:
┌──────────────────────────────────────┐
│ Create Account                   × │
├──────────────────────────────────────┤
│ Account Name *                       │
│ [BofA Checking___________________]   │ ← Data preserved
│                                      │
│ [Cancel]           [Create Account]  │ ← Can retry
└──────────────────────────────────────┘
```

**Archive Error (Account in Use):**

```
Toast (top-right, stays until dismissed):
┌──────────────────────────────────────────────┐
│ ❌ Cannot archive account                    │
│ This account has 3 pending transactions.     │
│ Resolve pending items before archiving.     │
│                                              │
│ [View Pending Items] [Dismiss]               │
└──────────────────────────────────────────────┘
```

---

### Search and Filter Interactions

**Real-time Search (Accounts List):**

```
User types "bofa" in search:

Before typing:
┌────────────────────────────────────────────┐
│ Search accounts... [__________________]    │
├────────────────────────────────────────────┤
│ CHECKING ACCOUNTS (2)                      │
│ SAVINGS ACCOUNTS (1)                       │
│ CREDIT CARD ACCOUNTS (2)                   │
└────────────────────────────────────────────┘

While typing "b":
┌────────────────────────────────────────────┐
│ Search accounts... [b_________________]    │
├────────────────────────────────────────────┤
│ Filtering... (200ms debounce)              │
└────────────────────────────────────────────┘

After debounce, "bofa":
┌────────────────────────────────────────────┐
│ Search accounts... [bofa______________]    │
│ Showing 3 of 5 accounts                    │
├────────────────────────────────────────────┤
│ CHECKING ACCOUNTS (1)                      │
│ ┌────────────────────────────────────────┐ │
│ │ BofA Personal Checking            USD  │ │
│ │ Bank of America                        │ │
│ └────────────────────────────────────────┘ │
│                                            │
│ SAVINGS ACCOUNTS (1)                       │
│ ┌────────────────────────────────────────┐ │
│ │ BofA Savings                      USD  │ │
│ │ Bank of America                        │ │
│ └────────────────────────────────────────┘ │
│                                            │
│ CREDIT CARD ACCOUNTS (1)                   │
│ ┌────────────────────────────────────────┐ │
│ │ BofA Credit                       USD  │ │
│ │ Bank of America                        │ │
│ └────────────────────────────────────────┘ │
└────────────────────────────────────────────┘

Search matches:
- Account name (BofA)
- Institution (Bank of America)
- Notes (if contain search term)
```

**Empty Search Results:**

```
User searches "hsbc":
┌────────────────────────────────────────────┐
│ Search accounts... [hsbc______________]    │
│ No accounts match "hsbc"                   │
├────────────────────────────────────────────┤
│                   🔍                       │
│                                            │
│         No matching accounts found         │
│                                            │
│ Try:                                       │
│ • Checking spelling                        │
│ • Using different keywords                 │
│ • Searching by institution name            │
│                                            │
│ [Clear Search]                             │
└────────────────────────────────────────────┘
```

**Filter by Account Type:**

```
Filter dropdown (collapsed):
┌────────────────────────────────────────────┐
│ Search accounts... [__________________]    │
│                              [Filter ▼]    │
│                              ☐ Show archived
├────────────────────────────────────────────┤

Filter dropdown (expanded):
┌────────────────────────────────────────────┐
│ Search accounts... [__________________]    │
│                              [Filter ▼]    │
│                               ↓            │
│                        ┌─────────────────┐ │
│                        │ Account Type    │ │
│                        ├─────────────────┤ │
│                        │ ☑ All Types     │ │
│                        │ ☐ Checking      │ │
│                        │ ☐ Savings       │ │
│                        │ ☐ Credit Card   │ │
│                        │ ☐ Cash          │ │
│                        │ ☐ Investment    │ │
│                        │ ☐ Loan          │ │
│                        ├─────────────────┤ │
│                        │ Currency        │ │
│                        ├─────────────────┤ │
│                        │ ☑ All           │ │
│                        │ ☐ USD only      │ │
│                        │ ☐ MXN only      │ │
│                        ├─────────────────┤ │
│                        │ [Apply]         │ │
│                        └─────────────────┘ │
├────────────────────────────────────────────┤

After selecting "Credit Card" only:
┌────────────────────────────────────────────┐
│ Search accounts... [__________________]    │
│ [Filter: Credit Card ×] ☐ Show archived   │
├────────────────────────────────────────────┤
│ Showing 2 of 5 accounts                    │
│                                            │
│ CREDIT CARD ACCOUNTS (2)                   │
│ ┌────────────────────────────────────────┐ │
│ │ BofA Credit                       USD  │ │
│ └────────────────────────────────────────┘ │
│ ┌────────────────────────────────────────┐ │
│ │ Amex Platinum                     USD  │ │
│ └────────────────────────────────────────┘ │
└────────────────────────────────────────────┘
```

---

### Mobile vs Desktop Considerations

**Mobile-Specific Behaviors:**

1. **Account List (Stacked Cards):**
   ```
   ┌──────────────────────────┐
   │ ☰  Accounts (5)      👤  │
   ├──────────────────────────┤
   │ [Search...] [Filter ▼]   │
   │ ☐ Show archived          │
   ├──────────────────────────┤
   │ CHECKING (2)             │
   │                          │
   │ ┌──────────────────────┐ │
   │ │ BofA Personal   USD  │ │
   │ │ Bank of America      │ │
   │ │ $3,245.67            │ │
   │ │ 127 transactions     │ │
   │ │                      │ │
   │ │ [Edit] [Archive]     │ │
   │ └──────────────────────┘ │
   │                          │
   │ ┌──────────────────────┐ │
   │ │ Chase Business  USD  │ │
   │ │ Chase                │ │
   │ │ $12,840.33           │ │
   │ │ 342 transactions     │ │
   │ │                      │ │
   │ │ [Edit] [Archive]     │ │
   │ └──────────────────────┘ │
   │                          │
   │ SAVINGS (1)              │
   │ ...                      │
   └──────────────────────────┘
   ```

2. **Create Account (Full Screen Modal):**
   ```
   ┌──────────────────────────┐
   │ ← Create Account         │
   ├──────────────────────────┤
   │ Account Name *           │
   │ [BofA Checking_________] │
   │                          │
   │ Account Type *           │
   │ [Checking ▼]             │
   │                          │
   │ Currency *               │
   │ [USD - US Dollar ▼]      │
   │                          │
   │ Institution              │
   │ [Bank of America_______] │
   │                          │
   │ Notes                    │
   │ [____________________]   │
   │                          │
   │ Initial Balance          │
   │ [$0.00_________________] │
   │                          │
   │                          │
   │ [Create Account]         │
   │                          │
   │ [Cancel]                 │
   └──────────────────────────┘
   ```

3. **Touch Targets:**
   - Minimum button size: 44x44px (Apple guideline)
   - Card tap area: Full card (not just buttons)
   - Swipe gestures:
     - Swipe left → Show edit/archive actions
     - Swipe right → Dismiss actions
   - Long press → Quick edit menu

4. **Account Selector (Bottom Sheet):**
   ```
   Transaction Edit View:
   ┌──────────────────────────┐
   │ Edit Transaction         │
   ├──────────────────────────┤
   │ Amount                   │
   │ [$127.45_______________] │
   │                          │
   │ Account                  │
   │ [BofA Personal... ▼]     │ ← Tapped
   └──────────────────────────┘
           ↓
   Bottom sheet slides up:
   ┌──────────────────────────┐
   │ ━━━ (drag handle)        │ ← Pull to dismiss
   ├──────────────────────────┤
   │ Select Account           │
   ├──────────────────────────┤
   │ [Search accounts...]     │
   ├──────────────────────────┤
   │ CHECKING                 │
   │ ✓ BofA Personal     USD  │
   │   Chase Business    USD  │
   │                          │
   │ SAVINGS                  │
   │   BofA Savings      USD  │
   │                          │
   │ CREDIT CARD              │
   │   BofA Credit       USD  │
   │   Amex Platinum     USD  │
   │                          │
   │ ☐ Show archived          │
   │                          │
   │ + Create New Account     │
   └──────────────────────────┘
   ```

**Desktop-Specific Features:**

1. **Hover States:**
   - Account card hover → Highlight border (blue, 2px)
   - Edit button hover → Background lightens
   - Archive button hover → Red background (warning)

2. **Multi-column Layout (wide screens >1200px):**
   ```
   ┌─────────────────────────┬─────────────────────────┐
   │ CHECKING (2)            │ CREDIT CARD (2)         │
   │ ┌─────────────────────┐ │ ┌─────────────────────┐ │
   │ │ BofA Personal       │ │ │ BofA Credit         │ │
   │ └─────────────────────┘ │ └─────────────────────┘ │
   │ ┌─────────────────────┐ │ ┌─────────────────────┐ │
   │ │ Chase Business      │ │ │ Amex Platinum       │ │
   │ └─────────────────────┘ │ └─────────────────────┘ │
   │                         │                         │
   │ SAVINGS (1)             │ CASH (1)                │
   │ ┌─────────────────────┐ │ ┌─────────────────────┐ │
   │ │ BofA Savings        │ │ │ Petty Cash          │ │
   │ └─────────────────────┘ │ └─────────────────────┘ │
   └─────────────────────────┴─────────────────────────┘
   ```

3. **Keyboard-only navigation:**
   - Tab stops: Search → Filter → Each account card → Actions
   - Focus indicators: 2px blue outline

---

## Edge Cases

### Edge Case 1: Duplicate Account Name

**Scenario:** User tries to create account with existing name.

**User Action:** Creating "BofA Checking" when it already exists.

**System Behavior:**

```
1. User fills form:
┌──────────────────────────────────────┐
│ Create Account                   × │
├──────────────────────────────────────┤
│ Account Name *                       │
│ [BofA Checking___________________]   │
│                                      │
│ Account Type *                       │
│ [Checking ▼]                         │
│                                      │
│ [Cancel]           [Create Account]  │
└──────────────────────────────────────┘

2. User clicks "Create Account"

3. Validation runs (client-side first, then server-side)

4. Error appears inline (no modal close):
┌──────────────────────────────────────┐
│ Create Account                   × │
├──────────────────────────────────────┤
│ Account Name *                       │
│ [BofA Checking___________________]   │
│ ❌ Account name "BofA Checking"      │
│    already exists                    │
│                                      │
│ Suggestions:                         │
│ • BofA Checking 2                    │
│ • BofA Personal Checking             │
│ • BofA Business Checking             │
│                                      │
│ [Use "BofA Checking 2"]              │ ← Quick action
│                                      │
│ Account Type *                       │
│ [Checking ▼]                         │
│                                      │
│ [Cancel]           [Create Account]  │
│                     (disabled)       │ ← Disabled until fixed
└──────────────────────────────────────┘

5. User clicks "Use 'BofA Checking 2'"

6. Name field auto-fills:
│ Account Name *                       │
│ [BofA Checking 2_________________]   │
│ ✅ Name available                    │

7. Create button re-enabled

8. User clicks "Create Account" → Success
```

**Alternative: Case-insensitive duplicate**

```
Existing: "BofA Checking"
User types: "bofa checking"

Error:
❌ Account name "bofa checking" matches
   existing account "BofA Checking"

Account names are case-insensitive to prevent
confusion.

Suggested: BofA Checking 2
```

---

### Edge Case 2: User Tries to Change Currency (Immutable Field)

**Scenario:** User editing account tries to change currency.

**User Action:** Clicks disabled currency dropdown in edit modal.

**System Behavior:**

```
1. User opens edit modal:
┌──────────────────────────────────────┐
│ Edit Account                     × │
├──────────────────────────────────────┤
│ Currency                             │
│ [USD - US Dollar ▼] (disabled)       │
│ ⓘ Cannot change currency after       │
│   creation                           │
└──────────────────────────────────────┘

2. User clicks disabled dropdown (nothing happens visually)

3. User clicks info icon (ⓘ)

4. Tooltip expands:
┌──────────────────────────────────────┐
│ Why can't I change the currency?     │
├──────────────────────────────────────┤
│ Account currency is locked after     │
│ creation to maintain data integrity. │
│                                      │
│ Changing currency would:             │
│ • Invalidate transaction amounts     │
│ • Break balance calculations         │
│ • Corrupt historical reports         │
│                                      │
│ Solution:                            │
│ If you need a different currency,    │
│ create a new account and transfer    │
│ future transactions.                 │
│                                      │
│ [Create New Account]  [Got It]       │
└──────────────────────────────────────┘

5. User clicks "Create New Account"

6. Edit modal closes, Create modal opens with:
   - Cursor focus on "Account Name"
   - Suggested name: "BofA Checking (MXN)"
   - Currency pre-selected to different currency
   - Note: "Replacement for BofA Checking (USD → MXN)"
```

**Developer Note:** Currency immutability enforced at:
- UI level: Field disabled
- Validation level: API rejects currency changes
- Database level: UPDATE query excludes `currency` column

---

### Edge Case 3: Archive Account with 100+ Transactions

**Scenario:** User archives account with significant transaction history.

**User Action:** Clicks "Archive" on account with 1,247 transactions.

**System Behavior:**

```
1. User clicks "Archive" button

2. System detects high transaction count (>100)

3. Enhanced confirmation dialog:
┌──────────────────────────────────────┐
│ Archive Account                      │
├──────────────────────────────────────┤
│ Are you sure you want to archive     │
│ this account?                        │
│                                      │
│ Account: BofA Personal Checking      │
│ Institution: Bank of America         │
│                                      │
│ ⚠️  This account has 1,247           │
│    transactions spanning 3.2 years   │
│                                      │
│ Date range: 2022-03-12 to 2025-05-23 │
│ Total volume: $127,459.32            │
│                                      │
│ Archiving will:                      │
│ • Preserve all 1,247 transactions    │
│ • Hide account from active lists     │
│ • Remove from transaction dropdowns  │
│ • Keep data for historical reports   │
│                                      │
│ ⚠️  Large account archives may slow  │
│    report generation. Consider       │
│    exporting data first.             │
│                                      │
│ [Export First]  [Cancel]  [Archive]  │
└──────────────────────────────────────┘

4. User clicks "Export First"

5. Export dialog opens:
┌──────────────────────────────────────┐
│ Export Account Data                  │
├──────────────────────────────────────┤
│ Account: BofA Personal Checking      │
│ Transactions: 1,247                  │
│                                      │
│ Format:                              │
│ ⦿ CSV (Excel compatible)             │
│ ○ JSON (raw data)                    │
│ ○ PDF (readable report)              │
│                                      │
│ Include:                             │
│ ☑ Transaction details                │
│ ☑ Account metadata                   │
│ ☑ Balance history                    │
│                                      │
│ [Cancel]            [Export & Archive]│
│                                      │
│ Or archive without exporting:        │
│ [Archive Without Export]             │
└──────────────────────────────────────┘

6. User clicks "Export & Archive"

7. Progress indicator:
┌──────────────────────────────────────┐
│ Exporting & Archiving...             │
├──────────────────────────────────────┤
│ Step 1: Exporting transactions...    │
│ [████████████████████░░░] 85%        │
│                                      │
│ Processing 1,060 of 1,247 rows...    │
│                                      │
│ Estimated: 5 seconds remaining       │
└──────────────────────────────────────┘

8. Export completes, archive begins:
┌──────────────────────────────────────┐
│ Exporting & Archiving...             │
├──────────────────────────────────────┤
│ Step 1: Export complete ✅           │
│ File: BofA-Personal-Checking.csv     │
│                                      │
│ Step 2: Archiving account...         │
│ [█████████░░░░░░░░░░░] 45%          │
│                                      │
│ Updating 1,247 transaction records...│
└──────────────────────────────────────┘

9. Success:
Toast:
┌──────────────────────────────────────┐
│ ✅ Account archived successfully     │
│ Export downloaded: BofA-Personal-... │
│                                      │
│ [Undo Archive]                       │
└──────────────────────────────────────┘

Account list updates (account hidden)
```

**Performance Optimization:**
- Archive operation runs as background job if >500 transactions
- User sees progress updates via WebSocket
- Export file size warning if >10MB

---

### Edge Case 4: Empty Search Results

**Scenario:** User searches for account that doesn't exist.

**User Action:** Searches "HSBC" (no HSBC accounts).

**System Behavior:**

```
1. User types "HSBC" in search:
┌────────────────────────────────────────────┐
│ Search accounts... [HSBC______________]    │
├────────────────────────────────────────────┤
│ Searching... (200ms debounce)              │
└────────────────────────────────────────────┘

2. After debounce, no results:
┌────────────────────────────────────────────┐
│ Search accounts... [HSBC______________] ×  │
│ No accounts match "HSBC"                   │
├────────────────────────────────────────────┤
│                   🔍                       │
│                                            │
│         No matching accounts found         │
│                                            │
│ Searched in:                               │
│ • Account names                            │
│ • Institution names                        │
│ • Account notes                            │
│                                            │
│ Try:                                       │
│ • Checking spelling                        │
│ • Using different keywords                 │
│ • Searching by currency (e.g., "USD")      │
│                                            │
│ [Clear Search]  [Create "HSBC" Account]    │
└────────────────────────────────────────────┘

3. User clicks "Create 'HSBC' Account"

4. Create modal opens with pre-filled name:
┌──────────────────────────────────────┐
│ Create Account                   × │
├──────────────────────────────────────┤
│ Account Name *                       │
│ [HSBC_____________________________]  │ ← Pre-filled
│                                      │
│ Institution (optional)               │
│ [HSBC_____________________________]  │ ← Auto-filled
│                                      │
│ Account Type *                       │
│ [Checking ▼]                         │
│                                      │
│ [Cancel]           [Create Account]  │
└──────────────────────────────────────┘

Alternative: User clicks "Clear Search"
→ Search field clears
→ Full account list reappears
```

**Smart Search Suggestions:**

```
User searches "bofa credit" (partial match):
┌────────────────────────────────────────────┐
│ Search accounts... [bofa credit_______] ×  │
│ Showing 1 of 5 accounts                    │
├────────────────────────────────────────────┤
│ CREDIT CARD ACCOUNTS (1)                   │
│ ┌────────────────────────────────────────┐ │
│ │ BofA Credit                       USD  │ │ ← Matched
│ │ Bank of America                        │ │
│ │ "BofA" and "Credit" matched            │ │
│ └────────────────────────────────────────┘ │
└────────────────────────────────────────────┘

Search highlighting (if implemented):
│ BofA Credit                       USD  │
  ^^^^  ^^^^^^ ← Matched portions highlighted
```

---

### Edge Case 5: Create Account During Transaction Edit

**Scenario:** User editing transaction realizes account doesn't exist yet.

**User Action:** Opens account dropdown, clicks "+ Create New Account".

**System Behavior:**

```
1. User in transaction edit modal:
┌──────────────────────────────────────┐
│ Edit Transaction                 × │
├──────────────────────────────────────┤
│ Amount                               │
│ [$450.00___________________________] │
│                                      │
│ Account *                            │
│ [Select account ▼] ← clicked         │
│  ↓                                   │
│  ┌────────────────────────────────┐  │
│  │ CHECKING (2)                   │  │
│  │   BofA Personal Checking       │  │
│  │   Chase Business               │  │
│  ├────────────────────────────────┤  │
│  │ + Create New Account           │  │ ← Clicked
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘

2. Create Account modal overlays transaction edit:
┌──────────────────────────────────────┐
│ Create Account (Quick)           × │
├──────────────────────────────────────┤
│ Account Name *                       │
│ [____________________________________]│
│                                      │
│ Account Type *                       │
│ [Checking ▼]                         │
│                                      │
│ Currency *                           │
│ [USD - US Dollar ▼]                  │
│                                      │
│ Institution (optional)               │
│ [____________________________________]│
│                                      │
│ ⓘ Creating account from transaction  │
│   edit. Advanced options available   │
│   in Settings > Accounts.            │
│                                      │
│ [Cancel]  [Create & Select Account]  │
└──────────────────────────────────────┘

3. User creates "Amex Gold":
│ Account Name *                       │
│ [Amex Gold_________________________] │
│                                      │
│ Account Type *                       │
│ [Credit Card ▼]                      │

4. User clicks "Create & Select Account"

5. Create Account modal closes

6. Transaction edit modal updates:
┌──────────────────────────────────────┐
│ Edit Transaction                 × │
├──────────────────────────────────────┤
│ Amount                               │
│ [$450.00___________________________] │
│                                      │
│ Account *                            │
│ [Amex Gold ▼]                        │ ← Auto-selected
│ ✅ New account created               │
│                                      │
│ Category *                           │
│ [Select category ▼]                  │
└──────────────────────────────────────┘

7. Success toast (lower priority, brief):
┌──────────────────────────────────────┐
│ ✅ Account 'Amex Gold' created       │
└──────────────────────────────────────┘

8. User continues editing transaction with new account selected
```

**Benefit:** Seamless workflow - user doesn't lose transaction context.

---

### Edge Case 6: Archived Account in Transaction Dropdown (Show/Hide)

**Scenario:** User has archived accounts, needs to decide whether to show them.

**Default State:** Archived accounts hidden in dropdowns.

**System Behavior:**

```
1. Transaction edit, account dropdown opened:
┌──────────────────────────────────────┐
│ Account *                            │
│ [Select account ▼] ← clicked         │
│  ↓                                   │
│  ┌────────────────────────────────┐  │
│  │ Search... [_________________]  │  │
│  ├────────────────────────────────┤  │
│  │ CHECKING (2)                   │  │
│  │   BofA Personal Checking       │  │
│  │   Chase Business               │  │
│  │                                │  │
│  │ CREDIT CARD (1)                │  │
│  │   BofA Credit                  │  │
│  ├────────────────────────────────┤  │
│  │ ☐ Show archived accounts (1)   │  │ ← Collapsed by default
│  ├────────────────────────────────┤  │
│  │ + Create New Account           │  │
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘

2. User checks "Show archived accounts":
┌──────────────────────────────────────┐
│  ┌────────────────────────────────┐  │
│  │ CHECKING (2)                   │  │
│  │   BofA Personal Checking       │  │
│  │   Chase Business               │  │
│  │                                │  │
│  │ CREDIT CARD (2)                │  │
│  │   BofA Credit                  │  │
│  │   Amex Platinum (archived)     │  │ ← Now visible
│  ├────────────────────────────────┤  │
│  │ ☑ Show archived accounts (1)   │  │
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘

3. User selects archived account:
┌──────────────────────────────────────┐
│ Account *                            │
│ [Amex Platinum (archived) ▼]         │
│ ⚠️  This account is archived         │
│                                      │
│ You can still assign transactions    │
│ to archived accounts for historical  │
│ accuracy.                            │
└──────────────────────────────────────┘

4. Warning badge appears but allows save:
[Save Transaction] ← Enabled, no blocking error
```

**Preference Persistence:**

```
User's "Show archived" preference saved per session:
- Checked in Transaction A edit → Remembered in Transaction B edit
- Reset on page refresh
- Can be made persistent in future (user settings)
```

---

## Performance Expectations

| Action | Target | Notes |
|--------|--------|-------|
| Load account list (≤10 accounts) | p95 < 300ms | Fetch from DB, render cards |
| Load account list (50 accounts) | p95 < 500ms | With virtual scrolling |
| Create account | p95 < 200ms | DB insert + cache invalidation |
| Edit account | p95 < 200ms | DB update + UI refresh |
| Archive account (<100 txns) | p95 < 300ms | Update account status + transaction flags |
| Archive account (500+ txns) | p95 < 2s | Background job, progress indicator |
| Archive account (5000+ txns) | Background job | Async with email notification when complete |
| Search filter (keystroke) | < 50ms | Client-side filtering with 200ms debounce |
| Account dropdown open | < 100ms | Cached account list |
| Account selector search | < 50ms | Real-time client-side filter |

---

## Accessibility Compliance

### WCAG 2.2 Level AA Requirements

**Screen Reader Compatibility:**

```
Account card announcement:
"Account card. BofA Personal Checking. Checking account.
Bank of America. US Dollar. Balance: $3,245.67.
127 transactions. Edit button. Archive button."

Empty state announcement:
"No accounts registered. Add your first account.
Button: Add First Account."

Create modal announcement:
"Dialog. Create Account. Form with 5 fields.
Account Name, required. Account Type, required..."

Success toast announcement:
"Alert. Account 'BofA Checking' created successfully."

Archive confirmation:
"Alert dialog. Archive Account. Are you sure you want to
archive this account? Account: Apple Card..."
```

**Keyboard Navigation:**

```
Tab order on Account List:
1. Search field
2. Filter dropdown
3. "Show archived" checkbox
4. "New Account" button
5. First account card (focus outline)
6. Edit button on first card
7. Archive button on first card
8. Second account card
9. Edit button on second card
...

Modal tab order:
1. Account Name field (auto-focused)
2. Account Type dropdown
3. Currency dropdown
4. Institution field
5. Notes field
6. Initial Balance field
7. Cancel button
8. Create Account button
Tab from last → cycles to first
```

**Color Contrast:**

```
Text on white background:
- Primary text (#1a1a1a): 15.8:1 ✅ (AAA)
- Secondary text (#666666): 5.7:1 ✅ (AA)
- Disabled text (#999999): 3.5:1 ⚠️ (AA Large only)

Button states:
- Primary button (blue #0066cc / white): 8.2:1 ✅
- Danger button (red #cc0000 / white): 9.1:1 ✅
- Disabled button (#e0e0e0 / #999999): 3.2:1 ⚠️ (borderline)

Status badges:
- Active (green #00aa00 / white): 4.8:1 ✅
- Archived (gray #666666 / white bg): 5.7:1 ✅
```

**Focus Indicators:**

```
Default focus (keyboard):
border: 2px solid #0066cc;
outline: 2px solid #0066cc;
outline-offset: 2px;
(Contrast ratio: 8.2:1 ✅)

High contrast mode:
border: 3px solid CanvasText;
outline: 3px solid Highlight;
```

**ARIA Labels:**

```html
<!-- Account card -->
<div
  role="article"
  aria-label="BofA Personal Checking account card"
>
  <h3>BofA Personal Checking</h3>
  <p aria-label="Institution">Bank of America</p>
  <p aria-label="Balance">$3,245.67</p>
  <p aria-label="Transaction count">127 transactions</p>

  <button
    aria-label="Edit BofA Personal Checking account"
  >
    Edit
  </button>

  <button
    aria-label="Archive BofA Personal Checking account"
  >
    Archive
  </button>
</div>

<!-- Account selector dropdown -->
<select
  aria-label="Select account for transaction"
  aria-required="true"
>
  <optgroup label="Checking Accounts">
    <option>BofA Personal Checking (USD)</option>
  </optgroup>
</select>

<!-- Create modal -->
<dialog
  role="dialog"
  aria-labelledby="create-account-title"
  aria-modal="true"
>
  <h2 id="create-account-title">Create Account</h2>
  ...
</dialog>
```

---

## Decision Points

### When to archive vs delete accounts?

**Archive (default recommendation):**
- Account has ANY transaction history
- Account closed but may need reference
- Legal/tax compliance requires historical data
- User uncertain about permanent deletion

**Delete (destructive action):**
- Account created by mistake (zero transactions)
- Duplicate account (zero transactions)
- Test account in sandbox/development
- User explicitly requests permanent deletion

**System enforcement:**
```javascript
// API validation
function deleteAccount(accountId) {
  const txnCount = getTransactionCount(accountId);

  if (txnCount > 0) {
    throw new Error(
      `Cannot delete account with ${txnCount} transactions. ` +
      `Archive instead to preserve history.`
    );
  }

  // Only allow delete if zero transactions
  performHardDelete(accountId);
}
```

**UI Behavior:**
- "Delete" button only appears if account has ZERO transactions
- Otherwise, show "Archive" button only
- Deleted accounts go to trash (30-day recovery window)

---

### When to show currency in account selector?

**Always show currency in these contexts:**
- Account list view (card badge)
- Account selector dropdown (suffix after name)
- Transaction edit (if multi-currency enabled)
- Export/reports (metadata)

**Hide currency in these contexts:**
- Single-currency setups (all accounts USD)
- Mobile selector (space constrained) — show on card detail only

**Implementation:**
```javascript
// Dynamic currency display
function formatAccountName(account, context) {
  const showCurrency =
    user.hasMultipleCurrencies() ||
    context === 'export' ||
    context === 'account_list';

  return showCurrency
    ? `${account.name} (${account.currency})`
    : account.name;
}
```

---

### When to cache account list?

**Cache Strategy:**

```http
# Account list (user-specific)
Cache-Control: private, max-age=600  # 10 minutes

# Account dropdown (within transaction edit)
Cache-Control: private, max-age=300  # 5 minutes
```

**Invalidation triggers:**
- Account created → Invalidate all account caches
- Account updated → Invalidate specific account + list cache
- Account archived → Invalidate list cache
- User logs out → Clear all caches

**Optimistic UI:**
```javascript
// Immediately update UI, rollback on error
function createAccount(data) {
  // 1. Optimistically add to UI
  const tempAccount = { ...data, id: 'temp_' + Date.now() };
  addToAccountList(tempAccount);

  // 2. Send API request
  const result = await api.createAccount(data);

  // 3. Replace temp with real account
  replaceInAccountList(tempAccount.id, result.account);

  // 4. On error: Remove from UI
  if (result.error) {
    removeFromAccountList(tempAccount.id);
    showError(result.error);
  }
}
```

---

**Next vertical:** 3.2 (Merchant/Entity Registry) — Closed registry of merchants, people, and institutions.
